'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
* @class
*/
var Engine = function () {
    /**
    * @constructor
    */
    function Engine() {
        _classCallCheck(this, Engine);

        if (Engine.instance instanceof Engine) {
            console.error('Engine.constructor: Engine instance already exists.');
            return null;
        }

        Engine.instance = this;

        this.lastTime = Date.now();
        this.gameObjectSet = new Set();
        this.collisionCandidateSet = new Set();
        this.keyCallbackSet = new Set();
        this.mouseCallbackSet = new Set();

        document.addEventListener('keyup', this.handleKeyEvents.bind(this));
        document.addEventListener('keydown', this.handleKeyEvents.bind(this));
        document.addEventListener('keypress', this.handleKeyEvents.bind(this));

        if (!Render) {
            console.error('Engine.constructor: Render class is not defined.');
        } else if (!(Render.instance instanceof Render)) {
            console.error('Engine.constructor: There is no render instance to subscribre mouse events.');
        } else {
            this.render = Render.instance;

            this.render.canvas.addEventListener('mouseover', this.handleMouseEvents.bind(this));
            this.render.canvas.addEventListener('mousemove', this.handleMouseEvents.bind(this));
            this.render.canvas.addEventListener('mouseleave', this.handleMouseEvents.bind(this));
            this.render.canvas.addEventListener('mouseout', this.handleMouseEvents.bind(this));
            this.render.canvas.addEventListener('click', this.handleMouseEvents.bind(this));
            this.render.canvas.addEventListener('auxclick', this.handleMouseEvents.bind(this));
            this.render.canvas.addEventListener('mousedown', this.handleMouseEvents.bind(this));
            this.render.canvas.addEventListener('mouseup', this.handleMouseEvents.bind(this));
        }
    }

    _createClass(Engine, [{
        key: 'handleKeyEvents',
        value: function handleKeyEvents(event) {
            var _iteratorNormalCompletion = true;
            var _didIteratorError = false;
            var _iteratorError = undefined;

            try {
                for (var _iterator = this.keyCallbackSet[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                    var callback = _step.value;

                    callback(event);
                }
            } catch (err) {
                _didIteratorError = true;
                _iteratorError = err;
            } finally {
                try {
                    if (!_iteratorNormalCompletion && _iterator.return) {
                        _iterator.return();
                    }
                } finally {
                    if (_didIteratorError) {
                        throw _iteratorError;
                    }
                }
            }
        }
    }, {
        key: 'handleMouseEvents',
        value: function handleMouseEvents(event) {
            var _iteratorNormalCompletion2 = true;
            var _didIteratorError2 = false;
            var _iteratorError2 = undefined;

            try {
                for (var _iterator2 = this.mouseCallbackSet[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
                    var callback = _step2.value;

                    callback(event);
                }
            } catch (err) {
                _didIteratorError2 = true;
                _iteratorError2 = err;
            } finally {
                try {
                    if (!_iteratorNormalCompletion2 && _iterator2.return) {
                        _iterator2.return();
                    }
                } finally {
                    if (_didIteratorError2) {
                        throw _iteratorError2;
                    }
                }
            }
        }
    }, {
        key: 'start',
        value: function start() {
            requestAnimationFrame(this.routine.bind(this));
        }
    }, {
        key: 'routine',
        value: function routine() {
            var deltaTime = (this.currentTime - this.lastTime) / 1000;

            var activeObjects = _.filter([].concat(_toConsumableArray(this.gameObjectSet)), function (gameObject) {
                return gameObject.active;
            });

            var _iteratorNormalCompletion3 = true;
            var _didIteratorError3 = false;
            var _iteratorError3 = undefined;

            try {
                for (var _iterator3 = activeObjects[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
                    var gameObject = _step3.value;

                    gameObject.earlyUpdate(deltaTime);
                }
            } catch (err) {
                _didIteratorError3 = true;
                _iteratorError3 = err;
            } finally {
                try {
                    if (!_iteratorNormalCompletion3 && _iterator3.return) {
                        _iterator3.return();
                    }
                } finally {
                    if (_didIteratorError3) {
                        throw _iteratorError3;
                    }
                }
            }

            this.checkForCollisions();

            var _iteratorNormalCompletion4 = true;
            var _didIteratorError4 = false;
            var _iteratorError4 = undefined;

            try {
                for (var _iterator4 = activeObjects[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
                    var _gameObject = _step4.value;

                    _gameObject.lateUpdate(deltaTime);
                }
            } catch (err) {
                _didIteratorError4 = true;
                _iteratorError4 = err;
            } finally {
                try {
                    if (!_iteratorNormalCompletion4 && _iterator4.return) {
                        _iterator4.return();
                    }
                } finally {
                    if (_didIteratorError4) {
                        throw _iteratorError4;
                    }
                }
            }

            this.render.render();

            this.lastTime = this.currentTime;

            requestAnimationFrame(this.routine.bind(this));
        }
    }, {
        key: 'checkForCollisions',
        value: function checkForCollisions() {
            var gameObjects = _.filter([].concat(_toConsumableArray(this.collisionCandidateSet)), function (gameObject) {
                return gameObject.active;
            });

            var _iteratorNormalCompletion5 = true;
            var _didIteratorError5 = false;
            var _iteratorError5 = undefined;

            try {
                for (var _iterator5 = _.filter(gameObjects, 'dynamic')[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
                    var dynamicObject = _step5.value;
                    var _iteratorNormalCompletion6 = true;
                    var _didIteratorError6 = false;
                    var _iteratorError6 = undefined;

                    try {
                        for (var _iterator6 = gameObjects[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {
                            var gameObject = _step6.value;

                            if (gameObject != dynamicObject) {
                                dynamicObject.onCollisionCheck(gameObject);
                            }
                        }
                    } catch (err) {
                        _didIteratorError6 = true;
                        _iteratorError6 = err;
                    } finally {
                        try {
                            if (!_iteratorNormalCompletion6 && _iterator6.return) {
                                _iterator6.return();
                            }
                        } finally {
                            if (_didIteratorError6) {
                                throw _iteratorError6;
                            }
                        }
                    }
                }
            } catch (err) {
                _didIteratorError5 = true;
                _iteratorError5 = err;
            } finally {
                try {
                    if (!_iteratorNormalCompletion5 && _iterator5.return) {
                        _iterator5.return();
                    }
                } finally {
                    if (_didIteratorError5) {
                        throw _iteratorError5;
                    }
                }
            }
        }

        /**
        * @callback routineCallback
        * @param {number} deltaTime - time since the callback was last called.
        */

        /**
        * @method registerUpdateCallback - add a callback to be invoked by the engine.
        * @param {routineCallback} callback
        */

    }, {
        key: 'registerUpdateCallback',
        value: function registerUpdateCallback(gameObject) {
            var registerCollisionCheck = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

            if (!GameObject) {
                console.error('Engine.registerUpdateCallback: GameObject class is not defined.');
            } else if (!(gameObject instanceof GameObject)) {
                console.error('Engine.registerUpdateCallback: gameObject is not an instance of GameObject.');
            } else {
                this.gameObjectSet.add(gameObject);

                if (registerCollisionCheck) {
                    this.collisionCandidateSet.add(gameObject);
                }
            }
        }
    }, {
        key: 'registerCollisionCandidate',
        value: function registerCollisionCandidate(gameObject) {
            if (!GameObject) {
                console.error('Engine.registerUpdateCallback: GameObject class is not defined.');
            } else if (!(gameObject instanceof GameObject)) {
                console.error('Engine.registerUpdateCallback: gameObject is not an instance of GameObject.');
            } else {
                this.collisionCandidateSet.add(gameObject);
            }
        }
    }, {
        key: 'unregisterGameObject',
        value: function unregisterGameObject(gameObject) {
            if (!GameObject) {
                console.error('Engine.registerUpdateCallback: GameObject class is not defined.');
            } else if (!(gameObject instanceof GameObject)) {
                console.error('Engine.registerUpdateCallback: gameObject is not an instance of GameObject.');
            } else {
                this.collisionCandidateSet.delete(gameObject);
                this.gameObjectSet.delete(gameObject);
            }
        }
    }, {
        key: 'registerKeyEventCallback',
        value: function registerKeyEventCallback(callback) {
            if (typeof callback == 'function') {
                this.keyCallbackSet.add(callback);
            } else {
                console.error('Engine.registerKeyEventCallback: callback is not set as a function.');
            }
        }
    }, {
        key: 'unregisterKeyEventCallback',
        value: function unregisterKeyEventCallback(callback) {
            if (typeof callback == 'function') {
                this.keyCallbackSet.delete(callback);
            } else {
                console.error('Engine.registerKeyEventCallback: callback is not set as a function.');
            }
        }
    }, {
        key: 'registerMouseEventCallback',
        value: function registerMouseEventCallback(callback) {
            if (typeof callback == 'function') {
                this.mouseCallbackSet.add(callback);
            } else {
                console.error('Engine.registerMouseEventCallback: callback is not set as a function.');
            }
        }
    }, {
        key: 'unregisterMouseEventCallback',
        value: function unregisterMouseEventCallback(callback) {
            if (typeof callback == 'function') {
                this.mouseCallbackSet.delete(callback);
            } else {
                console.error('Engine.registerMouseEventCallback: callback is not set as a function.');
            }
        }
    }, {
        key: 'currentTime',
        get: function get() {
            return Date.now();
        }
    }]);

    return Engine;
}();
"use strict";

var flat = {};
'use strict';

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
* @class
*/
var ImageObject = function () {
    /**
    * @constructor
    */
    function ImageObject(sprite) {
        var subscribeToRender = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

        _classCallCheck(this, ImageObject);

        if (sprite) {
            this.setSprite(sprite);
        }

        this.pivotX = 0.5;
        this.pivotY = 0.5;

        this.x = 0;
        this.y = 0;

        this.originalsizeX = this.originalsizeX || 0;
        this.originalsizeY = this.originalsizeY || 0;

        this.scaleX = 1;
        this.scaleY = 1;

        this.layer = 0;

        this.visible = true;

        if (!Render) {
            console.error('ImageObject.constructor: Render class is not defined.');
        } else if (!(Render.instance instanceof Render)) {
            console.error('ImageObject.constructor: There is no render instance to subscribre to.');
        } else {
            this.render = Render.instance;
            if (subscribeToRender) {
                this.subscribeToRender();
            }
        }
    }

    _createClass(ImageObject, [{
        key: 'mayRender',
        value: function mayRender() {
            return this.sprite instanceof Image && this.visible;
        }
    }, {
        key: 'setSprite',
        value: function setSprite(sprite) {
            var adjustSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

            if (sprite instanceof Image) {
                this.sprite = sprite;

                if (adjustSize) {
                    this.originalsizeX = sprite.naturalWidth;
                    this.originalsizeY = sprite.naturalHeight;
                }
            } else if (sprite) {
                console.error('GameObject.constructor: sprite is not set as a Image object.');
            } else {
                this.sprite = null;
            }
        }
    }, {
        key: 'subscribeToRender',
        value: function subscribeToRender() {
            this.render.registerObject(this);
        }
    }, {
        key: 'unsubscribeToRender',
        value: function unsubscribeToRender() {
            this.render.unregisterObject(this);
        }
    }, {
        key: 'createCopy',
        value: function createCopy() {
            var newCopy = new ImageObject(this.sprite, false);

            this.copyPropertiesTo(newCopy);

            return newCopy;
        }
    }, {
        key: 'copyPropertiesTo',
        value: function copyPropertiesTo(targetImageObject) {
            if (targetImageObject instanceof ImageObject) {
                targetImageObject.sprite = this.sprite;

                targetImageObject.pivot = [this.pivotX, this.pivotY];
                targetImageObject.position = [this.x, this.y];

                targetImageObject.originalsize = [this.originalsizeX, this.originalsizeY];

                targetImageObject.scale = [this.scaleX, this.scaleY];

                targetImageObject.layer = this.layer;
            } else {
                console.error('ImageObject.copyPropertiesTo: targetImageObject is not a ImageObject instance.');
            }
        }
    }, {
        key: 'pivot',
        get: function get() {
            return [this.pivotX, this.pivotY];
        },
        set: function set(pivot) {
            if (pivot instanceof Array && pivot.length == 2 && typeof pivot[0] == 'number' && typeof pivot[1] == 'number') {
                this.pivotX = pivot[0];
                this.pivotY = pivot[1];
            } else {
                console.error('set ImageObject.pivot: pivot is not an array of size 2 that contains numbers.');
            }
        }
    }, {
        key: 'position',
        get: function get() {
            return [this.x, this.y];
        },
        set: function set(position) {
            if (position instanceof Array && position.length == 2 && typeof position[0] == 'number' && typeof position[1] == 'number') {
                this.x = position[0];
                this.y = position[1];
            } else {
                console.error('set ImageObject.position: position is not an array of size 2 that contains numbers.');
            }
        }
    }, {
        key: 'sizeX',
        get: function get() {
            return this.originalsizeX * this.scaleX;
        }
    }, {
        key: 'sizeY',
        get: function get() {
            return this.originalsizeY * this.scaleY;
        }
    }, {
        key: 'size',
        get: function get() {
            return [this.originalsizeX * this.scaleX, this.originalsizeY * this.scaleY];
        }
    }, {
        key: 'originalsize',
        get: function get() {
            return [this.originalsizeX, this.originalsizeY];
        },
        set: function set(originalsize) {
            if (originalsize instanceof Array && originalsize.length == 2 && typeof originalsize[0] == 'number' && typeof originalsize[1] == 'number') {
                this.originalsizeX = originalsize[0];
                this.originalsizeY = originalsize[1];
            } else {
                console.error('set ImageObject.originalsize: originalsize is not an array of size 2 that contains numbers.');
            }
        }
    }, {
        key: 'scale',
        get: function get() {
            return [this.scaleX, this.scaleY];
        },
        set: function set(scale) {
            if (scale instanceof Array && scale.length == 2 && typeof scale[0] == 'number' && typeof scale[1] == 'number') {
                this.scaleX = scale[0];
                this.scaleY = scale[1];
            } else if (typeof scale == 'number') {
                this.scaleX = scale;
                this.scaleY = scale;
            } else {
                console.error('set ImageObject.scale: scale is not an array of size 2 that contains numbers or simply a number.');
            }
        }
    }]);

    return ImageObject;
}();

/**
* @class
*/


var GameObject = function (_ImageObject) {
    _inherits(GameObject, _ImageObject);

    /**
    * @constructor
    */
    function GameObject(sprite) {
        var subscribeToRender = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
        var subscribreToEngine = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;

        _classCallCheck(this, GameObject);

        var _this = _possibleConstructorReturn(this, (GameObject.__proto__ || Object.getPrototypeOf(GameObject)).call(this, sprite, subscribeToRender));

        _this.vx = 0;
        _this.vy = 0;

        _this.originalBorderWidth = _this.originalsizeX || 64;
        _this.originalBorderHeight = _this.originalsizeY || 64;

        _this.walkable = false;
        _this.dynamic = false;

        _this.step = [0, 0];

        _this.active = true;

        if (!Engine) {
            console.error('GameObject.constructor: Engine class is not defined.');
        } else if (!(Engine.instance instanceof Engine)) {
            console.error('GameObject.constructor: There is no Engine instance to subscribre to.');
        } else {
            _this.engine = Engine.instance;

            if (subscribreToEngine) {
                _this.subscribreToEngine();
            }
        }
        return _this;
    }

    _createClass(GameObject, [{
        key: 'subscribreToEngine',
        value: function subscribreToEngine() {
            this.engine.registerCollisionCandidate(this);
        }
    }, {
        key: 'unsubscribreToEngine',
        value: function unsubscribreToEngine() {
            this.engine.unregisterGameObject(this);
        }
    }, {
        key: 'mayRender',
        value: function mayRender() {
            return _get(GameObject.prototype.__proto__ || Object.getPrototypeOf(GameObject.prototype), 'mayRender', this).call(this) && this.active;
        }
    }, {
        key: 'earlyUpdate',
        value: function earlyUpdate(deltaTime) {
            this.step[0] = this.vx * deltaTime;
            this.step[1] = this.vy * deltaTime;
        }
    }, {
        key: 'lateUpdate',
        value: function lateUpdate() {
            this.x += this.step[0];
            this.y += this.step[1];
        }
    }, {
        key: 'hasCollided',
        value: function hasCollided(otherBorder) {
            var myBorder = this.border;

            return Math.min(myBorder.right, otherBorder.right) - Math.max(myBorder.left, otherBorder.left) >= 0 && Math.min(myBorder.top, otherBorder.top) - Math.max(myBorder.bottom, otherBorder.bottom) >= 0;
        }
    }, {
        key: 'onCollision',
        value: function onCollision(otherGameObject) {}
    }, {
        key: 'createCopy',
        value: function createCopy() {
            var newCopy = new GameObject(this.sprite, false);

            this.copyPropertiesTo(newCopy);

            return newCopy;
        }
    }, {
        key: 'copyPropertiesTo',
        value: function copyPropertiesTo(targetGameObject) {
            if (targetGameObject instanceof GameObject) {
                _get(GameObject.prototype.__proto__ || Object.getPrototypeOf(GameObject.prototype), 'copyPropertiesTo', this).call(this, targetGameObject);

                targetGameObject.vx = this.vx;
                targetGameObject.vy = this.vy;

                targetGameObject.originalBorderWidth = this.originalBorderWidth;
                targetGameObject.originalBorderHeight = this.originalBorderHeight;
            } else {
                console.error('GameObject.copyPropertiesTo: targetGameObject is not a GameObject instance.');
            }
        }
    }, {
        key: 'borderWidth',
        get: function get() {
            return this.originalBorderWidth * this.scaleX;
        }
    }, {
        key: 'borderHeight',
        get: function get() {
            return this.originalBorderHeight * this.scaleY;
        }
    }, {
        key: 'originalBorder',
        get: function get() {
            return [this.originalBorderWidth, this.originalBorderHeight];
        },
        set: function set(originalBorder) {
            if (originalBorder instanceof Array && originalBorder.length == 2 && typeof originalBorder[0] == 'number' && typeof originalBorder[1] == 'number') {
                this.originalBorderWidth = originalBorder[0];
                this.originalBorderHeight = originalBorder[1];
            } else {
                console.error('set ImageObject.originalBorder: originalBorder is not an array of size 2 that contains numbers.');
            }
        }
    }, {
        key: 'border',
        get: function get() {
            var borderRadius = [+0.5 * this.originalBorderWidth * this.scaleX, 0.5 * this.originalBorderHeight * this.scaleY];

            return {
                top: this.y + borderRadius[1],
                right: this.x + borderRadius[0],
                bottom: this.y - borderRadius[1],
                left: this.x - borderRadius[0]
            };
        }
    }]);

    return GameObject;
}(ImageObject);

/**
* @class
*/


var Player = function (_GameObject) {
    _inherits(Player, _GameObject);

    /**
    * @constructor
    */
    function Player(sprite) {
        var subscribeToEngine = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
        var subscribeToRender = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
        var upKeys = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [87, 38];
        var rightKeys = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : [68, 39];
        var downKeys = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : [83, 40];
        var leftKeys = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : [65, 37];

        _classCallCheck(this, Player);

        var _this2 = _possibleConstructorReturn(this, (Player.__proto__ || Object.getPrototypeOf(Player)).call(this, sprite, subscribeToRender, subscribeToEngine));

        _this2.keyMap = new Map();

        _this2.setKeyMap(upKeys, 'up');
        _this2.setKeyMap(rightKeys, 'right');
        _this2.setKeyMap(downKeys, 'down');
        _this2.setKeyMap(leftKeys, 'left');

        _this2.lastAction = 'none';

        _this2.moveSpeed = 200;

        _this2.walkable = true;
        _this2.dynamic = true;
        return _this2;
    }

    _createClass(Player, [{
        key: 'setKeyMap',
        value: function setKeyMap(keys, action) {
            var _iteratorNormalCompletion = true;
            var _didIteratorError = false;
            var _iteratorError = undefined;

            try {
                for (var _iterator = keys[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                    var key = _step.value;

                    this.keyMap.set(key, action);
                }
            } catch (err) {
                _didIteratorError = true;
                _iteratorError = err;
            } finally {
                try {
                    if (!_iteratorNormalCompletion && _iterator.return) {
                        _iterator.return();
                    }
                } finally {
                    if (_didIteratorError) {
                        throw _iteratorError;
                    }
                }
            }
        }
    }, {
        key: 'subscribreToEngine',
        value: function subscribreToEngine() {
            this.engine.registerKeyEventCallback(this.handleKeyEvents.bind(this));
            this.engine.registerUpdateCallback(this);
        }
    }, {
        key: 'unsubscribreToEngine',
        value: function unsubscribreToEngine() {
            _get(Player.prototype.__proto__ || Object.getPrototypeOf(Player.prototype), 'unsubscribreToEngine', this).call(this);
            this.engine.unregisterKeyEventCallback(this.handleKeyEvents);
        }
    }, {
        key: 'handleKeyEvents',
        value: function handleKeyEvents(event) {
            if (event.keyCode && this.keyMap.has(event.keyCode)) {
                var action = this.keyMap.get(event.keyCode);

                if (event.type == 'keyup') {
                    action += 'Cancel';
                }

                this.performAction(action);
            }
        }
    }, {
        key: 'onCollisionCheck',
        value: function onCollisionCheck(otherGameObject) {
            if (!otherGameObject.walkable) {
                var myBorder = void 0;
                var targetBorder = otherGameObject.border;

                if (this.step[0] != 0) {
                    myBorder = this.border;
                    myBorder.left += this.step[0];
                    myBorder.right += this.step[0];

                    if (otherGameObject.hasCollided(myBorder)) {
                        if (this.step[0] > 0) {
                            this.step[0] += targetBorder.left - myBorder.right - 1;
                        } else {
                            this.step[0] += targetBorder.right - myBorder.left + 1;
                        }
                    }
                }

                if (this.step[1] != 0) {
                    myBorder = this.border;
                    myBorder.top += this.step[1];
                    myBorder.bottom += this.step[1];

                    if (otherGameObject.hasCollided(myBorder)) {
                        if (this.step[1] > 0) {
                            this.step[1] += targetBorder.bottom - myBorder.top - 1;
                        } else {
                            this.step[1] += targetBorder.top - myBorder.bottom + 1;
                        }
                    }
                }
            }
        }
    }, {
        key: 'performAction',
        value: function performAction() {
            var action = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'none';

            if (this.active && this.lastAction != action) {
                switch (action) {
                    case 'up':
                        this.vy = this.moveSpeed;
                        break;
                    case 'upCancel':
                        if (this.vy > 0) {
                            this.vy = 0;
                        }
                        break;
                    case 'right':
                        this.vx = this.moveSpeed;
                        break;
                    case 'rightCancel':
                        if (this.vx > 0) {
                            this.vx = 0;
                        }
                        break;
                    case 'down':
                        this.vy = -this.moveSpeed;
                        break;
                    case 'downCancel':
                        if (this.vy < 0) {
                            this.vy = 0;
                        }
                        break;
                    case 'left':
                        this.vx = -this.moveSpeed;
                        break;
                    case 'leftCancel':
                        if (this.vx < 0) {
                            this.vx = 0;
                        }
                        break;
                    case 'none':
                        break;
                    default:
                }

                this.lastAction = action;
            }
        }
    }]);

    return Player;
}(GameObject);
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Render = function () {
    function Render(canvas) {
        _classCallCheck(this, Render);

        if (Render.instance instanceof Render) {
            console.error('Render.constructor: Render instance already exists.');
            return null;
        }

        if (!(canvas instanceof HTMLCanvasElement)) {
            console.error("Render.constructor: given canvas object is not an HTMLCanvasElement.");
            return null;
        }

        Render.instance = this;

        this.canvas = canvas;
        this.context2D = this.canvas.getContext('2d');

        this.updateCanvasSize();

        window.addEventListener('resize', this.updateCanvasSize);

        // Coordinate sytem. Axis orientation will be: X->right , Y->up
        this.originX = 0.5;
        this.originY = 0.5;

        this.coordOffsetX = 0;
        this.coordOffsetY = 0;

        this.objectSet = new Set();

        this.drawTileGrid = false;
        this.drawBorders = false;
        this.drawTileHighlight = false;
    }

    _createClass(Render, [{
        key: 'canvasPositionToRenderCoordinates',
        value: function canvasPositionToRenderCoordinates(position) {
            if (position instanceof Array && position.length == 2 && typeof position[0] == 'number' && typeof position[1] == 'number') {
                var realOrigin = this.realOrigin;

                return [position[0] - realOrigin[0], realOrigin[1] - position[1]];
            } else {
                console.error('set Render.canvasPositionToRenderCoordinates: position is not an array of size 2 that contains numbers.');
                return null;
            }
        }
    }, {
        key: 'mousePositionToCanvasRelativePosition',
        value: function mousePositionToCanvasRelativePosition(mousePosition) {
            var canvasRect = this.canvas.getBoundingClientRect();

            return [mousePosition[0] - canvasRect.left, mousePosition[1] - canvasRect.top];
        }
    }, {
        key: 'mousePositionToRenderCoordinates',
        value: function mousePositionToRenderCoordinates(mousePosition) {
            return this.canvasPositionToRenderCoordinates(this.mousePositionToCanvasRelativePosition(mousePosition));
        }
    }, {
        key: 'mousePositionToTileCoordinates',
        value: function mousePositionToTileCoordinates(mousePosition) {
            if (!Terrain) {
                console.error('Render.mousePositionToTileCoordinates: Terrain class is not defined.');
            } else if (!(this.terrain instanceof Terrain)) {
                console.error('Render.mousePositionToTileCoordinates: terrain is not set.');
            } else {
                var realOrigin = this.realOrigin;
                var relativeCanvasPosition = this.mousePositionToCanvasRelativePosition(mousePosition);

                var coordinates = [0.5 + (relativeCanvasPosition[0] - realOrigin[0]) / this.terrain.tileSizeX, -0.5 + (realOrigin[1] - relativeCanvasPosition[1]) / this.terrain.tileSizeY];

                return [Math.floor(coordinates[0]), Math.ceil(coordinates[1])];
            }
        }
    }, {
        key: 'updateCanvasSize',
        value: function updateCanvasSize() {
            var containerStyle = window.getComputedStyle(this.canvas.parentElement);

            this.canvas.width = parseFloat(containerStyle.width) - parseFloat(containerStyle.paddingLeft) - parseFloat(containerStyle.paddingRight) - parseFloat(containerStyle.borderLeftWidth) - parseFloat(containerStyle.borderRightWidth);
            this.canvas.height = parseFloat(containerStyle.height) - parseFloat(containerStyle.paddingTop) - parseFloat(containerStyle.paddingBottom) - parseFloat(containerStyle.borderTopWidth) - parseFloat(containerStyle.borderBottomWidth);
        }
    }, {
        key: 'registerObject',
        value: function registerObject(imageObject) {
            if (!ImageObject) {
                console.error('Render.registerObject: ImageObject class is not defined.');
            } else if (!(imageObject instanceof ImageObject)) {
                console.error('Render.registerObject: imageObject is not a ImageObject object.');
            } else {
                this.objectSet.add(imageObject);
            }
        }
    }, {
        key: 'unregisterObject',
        value: function unregisterObject(imageObject) {
            if (!ImageObject) {
                console.error('Render.registerObject: ImageObject class is not defined.');
            } else if (!(imageObject instanceof ImageObject)) {
                console.error('Render.registerObject: imageObject is not a ImageObject object.');
            } else {
                this.objectSet.delete(imageObject);
            }
        }
    }, {
        key: 'setTerrain',
        value: function setTerrain(terrain) {
            if (!Terrain) {
                console.error('Render.setTerrain: Terrain class is not defined.');
            } else if (!(terrain instanceof Terrain)) {
                console.error('Render.setTerrain: terrain is not a Terrain object.');
            } else {
                this.terrain = terrain;
            }
        }
    }, {
        key: 'render',
        value: function render() {
            this.context2D.clearRect(0, 0, this.canvas.width, this.canvas.height);

            this.renderTerrain();

            if (this.drawTileGrid) {
                this.renderTileGrid();
            }

            this.renderObjects();
        }
    }, {
        key: 'renderTerrain',
        value: function renderTerrain() {
            var realOrigin = this.realOrigin;

            this.context2D.fillStyle = 'rgba(255, 255, 255, 0.4)';

            if (this.terrain) {
                var _iteratorNormalCompletion = true;
                var _didIteratorError = false;
                var _iteratorError = undefined;

                try {
                    for (var _iterator = this.terrain.tiles[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                        var tile = _step.value;

                        var tilePosition = [(realOrigin[0] + (tile.row - 0.5) * this.terrain.tileSizeX).toFixed(), (realOrigin[1] - (tile.column + 0.5) * this.terrain.tileSizeY).toFixed()];

                        if (tile.sprite) {
                            this.context2D.drawImage(tile.sprite, tilePosition[0], tilePosition[1], this.terrain.tileSizeX.toFixed(), this.terrain.tileSizeY.toFixed());
                        }

                        if (this.drawTileHighlight && tile.highlighted) {
                            this.context2D.fillRect(tilePosition[0], tilePosition[1], this.terrain.tileSizeX.toFixed(), this.terrain.tileSizeY.toFixed());
                        }
                    }
                } catch (err) {
                    _didIteratorError = true;
                    _iteratorError = err;
                } finally {
                    try {
                        if (!_iteratorNormalCompletion && _iterator.return) {
                            _iterator.return();
                        }
                    } finally {
                        if (_didIteratorError) {
                            throw _iteratorError;
                        }
                    }
                }
            }
        }
    }, {
        key: 'renderObjects',
        value: function renderObjects() {
            var realOrigin = this.realOrigin;

            var objectSize = void 0,
                objectBorder = void 0;

            this.context2D.strokeStyle = 'purple';
            this.context2D.lineWidth = 2;

            var _iteratorNormalCompletion2 = true;
            var _didIteratorError2 = false;
            var _iteratorError2 = undefined;

            try {
                for (var _iterator2 = _.chain([].concat(_toConsumableArray(this.objectSet))).sortBy('y').reverse().sortBy('layer').value()[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
                    var objectToRender = _step2.value;

                    if (objectToRender.mayRender()) {
                        objectSize = objectToRender.size;
                        this.context2D.drawImage(objectToRender.sprite, (realOrigin[0] + objectToRender.x - objectToRender.pivotX * objectSize[0]).toFixed(), (realOrigin[1] - (objectToRender.y + (1 - objectToRender.pivotY) * objectSize[1])).toFixed(), objectSize[0].toFixed(), objectSize[1].toFixed());
                    }

                    if (this.drawBorders) {
                        if (!GameObject) {
                            console.error('Render.renderObjects: GameObject class not defined.');
                        } else if (objectToRender instanceof GameObject && objectToRender.active) {
                            objectBorder = objectToRender.border;
                            this.context2D.strokeRect(realOrigin[0] + objectBorder.left, realOrigin[1] - objectBorder.top, objectToRender.borderWidth, objectToRender.borderHeight);
                        }
                    }
                }
            } catch (err) {
                _didIteratorError2 = true;
                _iteratorError2 = err;
            } finally {
                try {
                    if (!_iteratorNormalCompletion2 && _iterator2.return) {
                        _iterator2.return();
                    }
                } finally {
                    if (_didIteratorError2) {
                        throw _iteratorError2;
                    }
                }
            }
        }
    }, {
        key: 'renderTileGrid',
        value: function renderTileGrid() {
            if (this.terrain) {
                this.context2D.strokeStyle = 'white';
                this.context2D.lineWidth = 1;

                var realOrigin = this.realOrigin;

                var minX = Math.ceil(0.5 - realOrigin[0] / this.terrain.tileSizeX);
                var maxX = Math.floor(0.5 + (this.canvas.width - realOrigin[0]) / this.terrain.tileSizeX);

                var minY = Math.ceil(-0.5 + (realOrigin[1] - this.canvas.height) / this.terrain.tileSizeY);
                var maxY = Math.floor(-0.5 + realOrigin[1] / this.terrain.tileSizeY);

                this.context2D.beginPath();

                var loackedPosition = 0;

                for (var i = minX; i <= maxX; i++) {
                    loackedPosition = (realOrigin[0] + (i - 0.5) * this.terrain.tileSizeX).toFixed();
                    this.context2D.moveTo(loackedPosition, 0);
                    this.context2D.lineTo(loackedPosition, this.canvas.height);
                }

                for (var j = minY; j <= maxY; j++) {
                    loackedPosition = (realOrigin[1] - (j + 0.5) * this.terrain.tileSizeY).toFixed();
                    this.context2D.moveTo(0, loackedPosition);
                    this.context2D.lineTo(this.canvas.width, loackedPosition);
                }

                this.context2D.stroke();
            }
        }
    }, {
        key: 'origin',
        get: function get() {
            return [this.originX, this.originY];
        },
        set: function set(origin) {
            if (origin instanceof Array && origin.length == 2 && typeof origin[0] == 'number' && typeof origin[1] == 'number') {
                this.originX = origin[0];
                this.originY = origin[1];
            } else {
                console.error('set Render.origin: origin is not an array of size 2 that contains numbers.');
            }
        }
    }, {
        key: 'coordOffset',
        get: function get() {
            return [this.coordOffsetX, this.coordOffsetY];
        },
        set: function set(coordOffset) {
            if (coordOffset instanceof Array && coordOffset.length == 2 && typeof coordOffset[0] == 'number' && typeof coordOffset[1] == 'number') {
                this.coordOffsetX = coordOffset[0].toFixed();
                this.coordOffsetY = coordOffset[1].toFixed();
            } else {
                console.error('set Render.coordOffset: coordOffset is not an array of size 2 that contains numbers.');
            }
        }
    }, {
        key: 'realOrigin',
        get: function get() {
            return [this.originX * this.canvas.width + this.coordOffsetX, (1 - this.originY) * this.canvas.height - this.coordOffsetY];
        }
    }]);

    return Render;
}();
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var ImageResourceStatus = {
    INITIATING: 'Initiating',
    FAILED: 'Failed',
    LOADING: 'Loading',
    LOADED: 'Loaded'
};

var ImageResource = function () {
    function ImageResource() {
        _classCallCheck(this, ImageResource);

        this.progress = 0;
        this.status = ImageResourceStatus.INITIATING;
        this.onLoad = null;
        this.onProgress = null;
        this.onStatusChanged = null;
    }

    _createClass(ImageResource, [{
        key: 'setProgress',
        value: function setProgress(progress) {
            this.progress = progress;

            console.log('ImageResource.setProgress: ' + progress);

            if (this.onProgress) {
                this.onProgress(this.progress);
            }
        }
    }, {
        key: 'setStatus',
        value: function setStatus(status) {
            this.status = status;

            if (this.onStatusChanged) {
                this.onStatusChanged(this.status);
            }

            switch (this.status) {
                case ImageResourceStatus.INITIATING:
                    break;

                case ImageResourceStatus.FAILED:
                    break;

                case ImageResourceStatus.LOADING:
                    break;

                case ImageResourceStatus.LOADED:
                    this.setProgress(1);
                    if (this.onLoad) {
                        this.onLoad();
                    }
                    break;

                default:
            }
        }
    }, {
        key: 'setTriggers',
        value: function setTriggers() {
            var _this = this;

            if (this.img) {
                this.promise = new Promise(function (resolve, reject) {
                    _this.img.onloadstart = function () {
                        _this.setStatus(ImageResourceStatus.LOADING);
                    };
                    _this.img.onprogress = function (progress) {
                        _this.progress = _this.setProgress(progress);
                    };
                    _this.img.onload = function () {
                        _this.setStatus(ImageResourceStatus.LOADED);
                        resolve(_this);
                    };
                    _this.img.onerror = function (error) {
                        _this.setStatus(ImageResourceStatus.FAILED);
                        reject(error);
                    };
                });
            }
        }
    }, {
        key: 'setSource',
        value: function setSource(source, alias) {
            var _this2 = this;

            if (source) {
                if (source instanceof Image) {
                    if (source.src) {
                        if (alias) {
                            this.alias = alias;
                        }

                        this.imageSrc = source.src;
                        this.img = source;

                        if (source.complete) {
                            this.setStatus(ImageResourceStatus.LOADED);

                            return new Promise(function (resolve, reject) {
                                resolve(_this2);
                            });
                        } else {
                            this.setTriggers();
                        }
                    } else {
                        console.error('ImageResource requires a proper source.');
                    }
                } else if (typeof source == 'string') {
                    if (alias) {
                        this.alias = alias;
                    }

                    this.imageSrc = source;
                    this.img = new Image();

                    this.setTriggers();

                    this.img.src = source;
                }

                return this.promise;
            } else {
                console.error('ImageResource requires a proper source.');
            }
        }
    }, {
        key: 'loaded',
        get: function get() {
            return this.status == ImageResourceStatus.LOADED;
        }
    }], [{
        key: 'IMAGE_STATUS',
        get: function get() {
            return ImageResourceStatus;
        }
    }]);

    return ImageResource;
}();

var Resources = function () {
    function Resources() {
        _classCallCheck(this, Resources);

        this.imageCache = new Map();
    }

    /**
    * @method addImage - Add an image resource and starts loading it if possible.
    * @param {Object|string} imgSource - image source. It may be an img element object or the img url string.
    * @param {string} [alias] - image alias used to retrieve resource. if imgSource is a string and alias is not specified, then the alias will be set to the imgSource.
    * @return {Promisse} - promise that fullfills when the resource has loaded.
    */


    _createClass(Resources, [{
        key: 'addImage',
        value: function addImage(imgSource, alias) {
            if (typeof imgSource == 'string' && !alias) {
                alias = imgSource;
            }

            var newImageResource = new ImageResource();

            if (!alias) {
                console.log('Resources.addImage: alias not set and thus this image will not be cached!');
            } else {
                if (this.imageCache.has(alias)) {
                    window.alert('Resources.addImage: image alias "' + alias + '" is already being used and will be overwritten.');
                }

                this.imageCache.set(alias, newImageResource);
            }

            return newImageResource.setSource(imgSource, alias);
        }

        /**
        * @method addImages - Same as addImage but for multple image resources.
        * @param {Array} sources - each element should be an array that matches the arguments of the addImage method: [imgSource, alias].
        * @return {Promisse} - promise that fullfills when all resources have loaded.
        */

    }, {
        key: 'addImages',
        value: function addImages(sources) {
            if (!(sources instanceof Array)) {
                console.error('Resources.addImages: argument is not an array');

                return;
            }

            var promises = [];

            var _iteratorNormalCompletion = true;
            var _didIteratorError = false;
            var _iteratorError = undefined;

            try {
                for (var _iterator = sources[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                    var entry = _step.value;

                    if (entry instanceof Array) {
                        promises.push(this.addImage.apply(this, entry));
                    } else {
                        promises.push(this.addImage(entry));
                    }
                }
            } catch (err) {
                _didIteratorError = true;
                _iteratorError = err;
            } finally {
                try {
                    if (!_iteratorNormalCompletion && _iterator.return) {
                        _iterator.return();
                    }
                } finally {
                    if (_didIteratorError) {
                        throw _iteratorError;
                    }
                }
            }

            return Promise.all(promises);
        }
    }, {
        key: 'getOrAddImage',
        value: function getOrAddImage(imgSource, alias) {
            if (typeof imgSource == 'string' && !alias) {
                alias = imgSource;
            }

            var newImageResource = new ImageResource();

            if (!alias) {
                console.log('Resources.addImage: alias not set and thus this image will not be cached!');
            } else {
                var cache = this.imageCache.get(alias);

                if (cache) {
                    return new Promise(function (resolve, reject) {
                        resolve(cache);
                    });
                }
            }

            this.imageCache.set(alias, newImageResource);

            return newImageResource.setSource(imgSource, alias);
        }
    }, {
        key: 'getOrAddImages',
        value: function getOrAddImages(sources) {
            if (!(sources instanceof Array)) {
                console.error('Resources.addImages: argument is not an array');

                return;
            }

            var promises = [];

            var _iteratorNormalCompletion2 = true;
            var _didIteratorError2 = false;
            var _iteratorError2 = undefined;

            try {
                for (var _iterator2 = sources[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
                    var entry = _step2.value;

                    if (entry instanceof Array) {
                        promises.push(this.getOrAddImage.apply(this, entry));
                    } else {
                        promises.push(this.getOrAddImage(entry));
                    }
                }
            } catch (err) {
                _didIteratorError2 = true;
                _iteratorError2 = err;
            } finally {
                try {
                    if (!_iteratorNormalCompletion2 && _iterator2.return) {
                        _iterator2.return();
                    }
                } finally {
                    if (_didIteratorError2) {
                        throw _iteratorError2;
                    }
                }
            }

            return Promise.all(promises);
        }

        /**
        * @method getImage - returns the img element object respective to the given alias.
        */

    }, {
        key: 'getImage',
        value: function getImage(alias) {
            var cache = this.imageCache.get(alias);

            if (!cache) {
                console.error('Resources.getImage: could not find alias "${alias}"');
            }

            return cache;
        }
    }]);

    return Resources;
}();
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Tile = function Tile(row, column, sprite) {
    _classCallCheck(this, Tile);

    if (sprite instanceof Image) {
        this.sprite = sprite;
    } else if (sprite) {
        console.error('Tile.constructor: sprite is not a Image object.');
        return null;
    }

    row = Number(row.toFixed());
    column = Number(column.toFixed());

    if (typeof row == 'number' && typeof column == 'number') {
        this.row = row;
        this.column = column;
    } else {
        console.error('Tile.constructor: row and column must be numbers.');
        return null;
    }

    this.highlighted = false;
};

var Terrain = function () {
    function Terrain() {
        _classCallCheck(this, Terrain);

        this.tileSizeX = 64;
        this.tileSizeY = 64;

        this.tileMap = new Map();
        this.tileHighlightMap = new Map();
    }

    _createClass(Terrain, [{
        key: 'setTile',
        value: function setTile(tile) {
            if (!(tile instanceof Tile)) {
                console.error('Terrain.setTile: tile is not a Tile object.');
            } else {
                this.tileMap.set(tile.row + 'x' + tile.column, tile);
            }
        }
    }, {
        key: 'setTiles',
        value: function setTiles(tiles) {
            if (!(tiles instanceof Array)) {
                console.error('Terrain.setTiles: tiles is not an Array.');
            } else {
                var _iteratorNormalCompletion = true;
                var _didIteratorError = false;
                var _iteratorError = undefined;

                try {
                    for (var _iterator = tiles[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                        var tile = _step.value;

                        this.setTile(tile);
                    }
                } catch (err) {
                    _didIteratorError = true;
                    _iteratorError = err;
                } finally {
                    try {
                        if (!_iteratorNormalCompletion && _iterator.return) {
                            _iterator.return();
                        }
                    } finally {
                        if (_didIteratorError) {
                            throw _iteratorError;
                        }
                    }
                }
            }
        }
    }, {
        key: 'setTileHighlight',
        value: function setTileHighlight(row, column) {
            var highlighted = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;

            if (typeof row == 'number' && typeof column == 'number' && typeof highlighted == 'boolean') {
                var tile = this.tileMap.get(row + 'x' + column);
                if (!tile) {
                    tile = new Tile(row, column);
                    this.setTile(tile);
                }

                tile.highlighted = highlighted;

                return tile;
            } else {
                console.error('Terrain.setTileHighlight: row and column must be numbers and highlighted must be a boolean.');
            }

            return null;
        }
    }, {
        key: 'clear',
        value: function clear() {
            this.tileMap.clear();
            this.tileHighlightMap = new Map();
        }
    }, {
        key: 'tiles',
        get: function get() {
            return [].concat(_toConsumableArray(this.tileMap.values()));
        }
    }, {
        key: 'tileSize',
        get: function get() {
            return [this.tileSizeX, this.tileSizeY];
        },
        set: function set(tileSize) {
            if (tileSize instanceof Array && tileSize.length == 2 && typeof tileSize[0] == 'number' && typeof tileSize[1] == 'number') {
                this.tileSizeX = tileSize[0];
                this.tileSizeY = tileSize[1];
            } else {
                console.error('set Terrain.tileSize: tileSize is not an array of size 2 that contains numbers.');
            }
        }
    }]);

    return Terrain;
}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVuZ2luZS5qcyIsImZsYXQuanMiLCJnYW1lLW9iamVjdC5qcyIsInJlbmRlci5qcyIsInJlc291cmNlcy5qcyIsInRlcnJhaW4uanMiXSwibmFtZXMiOlsiRW5naW5lIiwiaW5zdGFuY2UiLCJjb25zb2xlIiwiZXJyb3IiLCJsYXN0VGltZSIsIkRhdGUiLCJub3ciLCJnYW1lT2JqZWN0U2V0IiwiU2V0IiwiY29sbGlzaW9uQ2FuZGlkYXRlU2V0Iiwia2V5Q2FsbGJhY2tTZXQiLCJtb3VzZUNhbGxiYWNrU2V0IiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlS2V5RXZlbnRzIiwiYmluZCIsIlJlbmRlciIsInJlbmRlciIsImNhbnZhcyIsImhhbmRsZU1vdXNlRXZlbnRzIiwiZXZlbnQiLCJjYWxsYmFjayIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInJvdXRpbmUiLCJkZWx0YVRpbWUiLCJjdXJyZW50VGltZSIsImFjdGl2ZU9iamVjdHMiLCJfIiwiZmlsdGVyIiwiZ2FtZU9iamVjdCIsImFjdGl2ZSIsImVhcmx5VXBkYXRlIiwiY2hlY2tGb3JDb2xsaXNpb25zIiwibGF0ZVVwZGF0ZSIsImdhbWVPYmplY3RzIiwiZHluYW1pY09iamVjdCIsIm9uQ29sbGlzaW9uQ2hlY2siLCJyZWdpc3RlckNvbGxpc2lvbkNoZWNrIiwiR2FtZU9iamVjdCIsImFkZCIsImRlbGV0ZSIsImZsYXQiLCJJbWFnZU9iamVjdCIsInNwcml0ZSIsInN1YnNjcmliZVRvUmVuZGVyIiwic2V0U3ByaXRlIiwicGl2b3RYIiwicGl2b3RZIiwieCIsInkiLCJvcmlnaW5hbHNpemVYIiwib3JpZ2luYWxzaXplWSIsInNjYWxlWCIsInNjYWxlWSIsImxheWVyIiwidmlzaWJsZSIsIkltYWdlIiwiYWRqdXN0U2l6ZSIsIm5hdHVyYWxXaWR0aCIsIm5hdHVyYWxIZWlnaHQiLCJyZWdpc3Rlck9iamVjdCIsInVucmVnaXN0ZXJPYmplY3QiLCJuZXdDb3B5IiwiY29weVByb3BlcnRpZXNUbyIsInRhcmdldEltYWdlT2JqZWN0IiwicGl2b3QiLCJwb3NpdGlvbiIsIm9yaWdpbmFsc2l6ZSIsInNjYWxlIiwiQXJyYXkiLCJsZW5ndGgiLCJzdWJzY3JpYnJlVG9FbmdpbmUiLCJ2eCIsInZ5Iiwib3JpZ2luYWxCb3JkZXJXaWR0aCIsIm9yaWdpbmFsQm9yZGVySGVpZ2h0Iiwid2Fsa2FibGUiLCJkeW5hbWljIiwic3RlcCIsImVuZ2luZSIsInJlZ2lzdGVyQ29sbGlzaW9uQ2FuZGlkYXRlIiwidW5yZWdpc3RlckdhbWVPYmplY3QiLCJvdGhlckJvcmRlciIsIm15Qm9yZGVyIiwiYm9yZGVyIiwiTWF0aCIsIm1pbiIsInJpZ2h0IiwibWF4IiwibGVmdCIsInRvcCIsImJvdHRvbSIsIm90aGVyR2FtZU9iamVjdCIsInRhcmdldEdhbWVPYmplY3QiLCJvcmlnaW5hbEJvcmRlciIsImJvcmRlclJhZGl1cyIsIlBsYXllciIsInN1YnNjcmliZVRvRW5naW5lIiwidXBLZXlzIiwicmlnaHRLZXlzIiwiZG93bktleXMiLCJsZWZ0S2V5cyIsImtleU1hcCIsIk1hcCIsInNldEtleU1hcCIsImxhc3RBY3Rpb24iLCJtb3ZlU3BlZWQiLCJrZXlzIiwiYWN0aW9uIiwia2V5Iiwic2V0IiwicmVnaXN0ZXJLZXlFdmVudENhbGxiYWNrIiwicmVnaXN0ZXJVcGRhdGVDYWxsYmFjayIsInVucmVnaXN0ZXJLZXlFdmVudENhbGxiYWNrIiwia2V5Q29kZSIsImhhcyIsImdldCIsInR5cGUiLCJwZXJmb3JtQWN0aW9uIiwidGFyZ2V0Qm9yZGVyIiwiaGFzQ29sbGlkZWQiLCJIVE1MQ2FudmFzRWxlbWVudCIsImNvbnRleHQyRCIsImdldENvbnRleHQiLCJ1cGRhdGVDYW52YXNTaXplIiwid2luZG93Iiwib3JpZ2luWCIsIm9yaWdpblkiLCJjb29yZE9mZnNldFgiLCJjb29yZE9mZnNldFkiLCJvYmplY3RTZXQiLCJkcmF3VGlsZUdyaWQiLCJkcmF3Qm9yZGVycyIsImRyYXdUaWxlSGlnaGxpZ2h0IiwicmVhbE9yaWdpbiIsIm1vdXNlUG9zaXRpb24iLCJjYW52YXNSZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiY2FudmFzUG9zaXRpb25Ub1JlbmRlckNvb3JkaW5hdGVzIiwibW91c2VQb3NpdGlvblRvQ2FudmFzUmVsYXRpdmVQb3NpdGlvbiIsIlRlcnJhaW4iLCJ0ZXJyYWluIiwicmVsYXRpdmVDYW52YXNQb3NpdGlvbiIsImNvb3JkaW5hdGVzIiwidGlsZVNpemVYIiwidGlsZVNpemVZIiwiZmxvb3IiLCJjZWlsIiwiY29udGFpbmVyU3R5bGUiLCJnZXRDb21wdXRlZFN0eWxlIiwicGFyZW50RWxlbWVudCIsIndpZHRoIiwicGFyc2VGbG9hdCIsInBhZGRpbmdMZWZ0IiwicGFkZGluZ1JpZ2h0IiwiYm9yZGVyTGVmdFdpZHRoIiwiYm9yZGVyUmlnaHRXaWR0aCIsImhlaWdodCIsInBhZGRpbmdUb3AiLCJwYWRkaW5nQm90dG9tIiwiYm9yZGVyVG9wV2lkdGgiLCJib3JkZXJCb3R0b21XaWR0aCIsImltYWdlT2JqZWN0IiwiY2xlYXJSZWN0IiwicmVuZGVyVGVycmFpbiIsInJlbmRlclRpbGVHcmlkIiwicmVuZGVyT2JqZWN0cyIsImZpbGxTdHlsZSIsInRpbGVzIiwidGlsZSIsInRpbGVQb3NpdGlvbiIsInJvdyIsInRvRml4ZWQiLCJjb2x1bW4iLCJkcmF3SW1hZ2UiLCJoaWdobGlnaHRlZCIsImZpbGxSZWN0Iiwib2JqZWN0U2l6ZSIsIm9iamVjdEJvcmRlciIsInN0cm9rZVN0eWxlIiwibGluZVdpZHRoIiwiY2hhaW4iLCJzb3J0QnkiLCJyZXZlcnNlIiwidmFsdWUiLCJvYmplY3RUb1JlbmRlciIsIm1heVJlbmRlciIsInNpemUiLCJzdHJva2VSZWN0IiwiYm9yZGVyV2lkdGgiLCJib3JkZXJIZWlnaHQiLCJtaW5YIiwibWF4WCIsIm1pblkiLCJtYXhZIiwiYmVnaW5QYXRoIiwibG9hY2tlZFBvc2l0aW9uIiwiaSIsIm1vdmVUbyIsImxpbmVUbyIsImoiLCJzdHJva2UiLCJvcmlnaW4iLCJjb29yZE9mZnNldCIsIkltYWdlUmVzb3VyY2VTdGF0dXMiLCJJTklUSUFUSU5HIiwiRkFJTEVEIiwiTE9BRElORyIsIkxPQURFRCIsIkltYWdlUmVzb3VyY2UiLCJwcm9ncmVzcyIsInN0YXR1cyIsIm9uTG9hZCIsIm9uUHJvZ3Jlc3MiLCJvblN0YXR1c0NoYW5nZWQiLCJsb2ciLCJzZXRQcm9ncmVzcyIsImltZyIsInByb21pc2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIm9ubG9hZHN0YXJ0Iiwic2V0U3RhdHVzIiwib25wcm9ncmVzcyIsIm9ubG9hZCIsIm9uZXJyb3IiLCJzb3VyY2UiLCJhbGlhcyIsInNyYyIsImltYWdlU3JjIiwiY29tcGxldGUiLCJzZXRUcmlnZ2VycyIsIlJlc291cmNlcyIsImltYWdlQ2FjaGUiLCJpbWdTb3VyY2UiLCJuZXdJbWFnZVJlc291cmNlIiwiYWxlcnQiLCJzZXRTb3VyY2UiLCJzb3VyY2VzIiwicHJvbWlzZXMiLCJlbnRyeSIsInB1c2giLCJhZGRJbWFnZSIsImFwcGx5IiwiYWxsIiwiY2FjaGUiLCJnZXRPckFkZEltYWdlIiwiVGlsZSIsIk51bWJlciIsInRpbGVNYXAiLCJ0aWxlSGlnaGxpZ2h0TWFwIiwic2V0VGlsZSIsImNsZWFyIiwidmFsdWVzIiwidGlsZVNpemUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7OztJQUdNQTtBQUNGOzs7QUFHQSxzQkFBYztBQUFBOztBQUNWLFlBQUdBLE9BQU9DLFFBQVAsWUFBMkJELE1BQTlCLEVBQXNDO0FBQ2xDRSxvQkFBUUMsS0FBUixDQUFjLHFEQUFkO0FBQ0EsbUJBQU8sSUFBUDtBQUNIOztBQUVESCxlQUFPQyxRQUFQLEdBQWtCLElBQWxCOztBQUVBLGFBQUtHLFFBQUwsR0FBZ0JDLEtBQUtDLEdBQUwsRUFBaEI7QUFDQSxhQUFLQyxhQUFMLEdBQXFCLElBQUlDLEdBQUosRUFBckI7QUFDQSxhQUFLQyxxQkFBTCxHQUE2QixJQUFJRCxHQUFKLEVBQTdCO0FBQ0EsYUFBS0UsY0FBTCxHQUFz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ekwsTUFBVCxJQUFtQixDQUFuRCxJQUEwRCxPQUFPeUwsU0FBUyxDQUFULENBQVAsSUFBc0IsUUFBaEYsSUFBOEYsT0FBT0EsU0FBUyxDQUFULENBQVAsSUFBc0IsUUFBeEgsRUFBb0k7QUFDaEkscUJBQUsvRyxTQUFMLEdBQWlCK0csU0FBUyxDQUFULENBQWpCO0FBQ0EscUJBQUs5RyxTQUFMLEdBQWlCOEcsU0FBUyxDQUFULENBQWpCO0FBQ0gsYUFIRCxNQUlLO0FBQ0Q3UCx3QkFBUUMsS0FBUixDQUFjLGlGQUFkO0FBQ0g7QUFDSiIsImZpbGUiOiJmbGF0LWVuZ2luZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuKiBAY2xhc3NcclxuKi9cclxuY2xhc3MgRW5naW5lIHtcclxuICAgIC8qKlxyXG4gICAgKiBAY29uc3RydWN0b3JcclxuICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBpZihFbmdpbmUuaW5zdGFuY2UgaW5zdGFuY2VvZiBFbmdpbmUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRW5naW5lLmNvbnN0cnVjdG9yOiBFbmdpbmUgaW5zdGFuY2UgYWxyZWFkeSBleGlzdHMuJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgRW5naW5lLmluc3RhbmNlID0gdGhpcztcclxuXHJcbiAgICAgICAgdGhpcy5sYXN0VGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgdGhpcy5nYW1lT2JqZWN0U2V0ID0gbmV3IFNldCgpO1xyXG4gICAgICAgIHRoaXMuY29sbGlzaW9uQ2FuZGlkYXRlU2V0ID0gbmV3IFNldCgpO1xyXG4gICAgICAgIHRoaXMua2V5Q2FsbGJhY2tTZXQgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgdGhpcy5tb3VzZUNhbGxiYWNrU2V0ID0gbmV3IFNldCgpO1xyXG5cclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuaGFuZGxlS2V5RXZlbnRzLmJpbmQodGhpcykpO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleUV2ZW50cy5iaW5kKHRoaXMpKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIHRoaXMuaGFuZGxlS2V5RXZlbnRzLmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICBpZighUmVuZGVyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0VuZ2luZS5jb25zdHJ1Y3RvcjogUmVuZGVyIGNsYXNzIGlzIG5vdCBkZWZpbmVkLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKCEoUmVuZGVyLmluc3RhbmNlIGluc3RhbmNlb2YgUmVuZGVyKSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFbmdpbmUuY29uc3RydWN0b3I6IFRoZXJlIGlzIG5vIHJlbmRlciBpbnN0YW5jZSB0byBzdWJzY3JpYnJlIG1vdXNlIGV2ZW50cy4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyID0gUmVuZGVyLmluc3RhbmNlO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIHRoaXMuaGFuZGxlTW91c2VFdmVudHMuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLmhhbmRsZU1vdXNlRXZlbnRzLmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIHRoaXMuaGFuZGxlTW91c2VFdmVudHMuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIHRoaXMuaGFuZGxlTW91c2VFdmVudHMuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlTW91c2VFdmVudHMuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdhdXhjbGljaycsIHRoaXMuaGFuZGxlTW91c2VFdmVudHMuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmhhbmRsZU1vdXNlRXZlbnRzLmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuaGFuZGxlTW91c2VFdmVudHMuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZUtleUV2ZW50cyhldmVudCkge1xyXG4gICAgICAgIGZvcihjb25zdCBjYWxsYmFjayBvZiB0aGlzLmtleUNhbGxiYWNrU2V0KSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlTW91c2VFdmVudHMoZXZlbnQpIHtcclxuICAgICAgICBmb3IoY29uc3QgY2FsbGJhY2sgb2YgdGhpcy5tb3VzZUNhbGxiYWNrU2V0KSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc3RhcnQoKSB7XHJcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMucm91dGluZS5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgY3VycmVudFRpbWUoKSB7XHJcbiAgICAgICAgcmV0dXJuIERhdGUubm93KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcm91dGluZSgpIHtcclxuICAgICAgICBjb25zdCBkZWx0YVRpbWUgPSAodGhpcy5jdXJyZW50VGltZSAtIHRoaXMubGFzdFRpbWUpLzEwMDA7XHJcblxyXG4gICAgICAgIGNvbnN0IGFjdGl2ZU9iamVjdHMgPSBfLmZpbHRlcihbLi4udGhpcy5nYW1lT2JqZWN0U2V0XSwgZ2FtZU9iamVjdCA9PiBnYW1lT2JqZWN0LmFjdGl2ZSk7XHJcblxyXG4gICAgICAgIGZvcihjb25zdCBnYW1lT2JqZWN0IG9mIGFjdGl2ZU9iamVjdHMpIHtcclxuICAgICAgICAgICAgZ2FtZU9iamVjdC5lYXJseVVwZGF0ZShkZWx0YVRpbWUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jaGVja0ZvckNvbGxpc2lvbnMoKTtcclxuXHJcbiAgICAgICAgZm9yKGNvbnN0IGdhbWVPYmplY3Qgb2YgYWN0aXZlT2JqZWN0cykge1xyXG4gICAgICAgICAgICBnYW1lT2JqZWN0LmxhdGVVcGRhdGUoZGVsdGFUaW1lKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucmVuZGVyLnJlbmRlcigpO1xyXG5cclxuICAgICAgICB0aGlzLmxhc3RUaW1lID0gdGhpcy5jdXJyZW50VGltZTtcclxuXHJcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMucm91dGluZS5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBjaGVja0ZvckNvbGxpc2lvbnMoKSB7XHJcbiAgICAgICAgY29uc3QgZ2FtZU9iamVjdHMgPSBfLmZpbHRlcihbLi4udGhpcy5jb2xsaXNpb25DYW5kaWRhdGVTZXRdLCBnYW1lT2JqZWN0ID0+IGdhbWVPYmplY3QuYWN0aXZlKTtcclxuXHJcbiAgICAgICAgZm9yKGNvbnN0IGR5bmFtaWNPYmplY3Qgb2YgXy5maWx0ZXIoZ2FtZU9iamVjdHMsICdkeW5hbWljJykpIHtcclxuICAgICAgICAgICAgZm9yKGNvbnN0IGdhbWVPYmplY3Qgb2YgZ2FtZU9iamVjdHMpIHtcclxuICAgICAgICAgICAgICAgIGlmKGdhbWVPYmplY3QgIT0gZHluYW1pY09iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGR5bmFtaWNPYmplY3Qub25Db2xsaXNpb25DaGVjayhnYW1lT2JqZWN0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICogQGNhbGxiYWNrIHJvdXRpbmVDYWxsYmFja1xyXG4gICAgKiBAcGFyYW0ge251bWJlcn0gZGVsdGFUaW1lIC0gdGltZSBzaW5jZSB0aGUgY2FsbGJhY2sgd2FzIGxhc3QgY2FsbGVkLlxyXG4gICAgKi9cclxuXHJcbiAgICAvKipcclxuICAgICogQG1ldGhvZCByZWdpc3RlclVwZGF0ZUNhbGxiYWNrIC0gYWRkIGEgY2FsbGJhY2sgdG8gYmUgaW52b2tlZCBieSB0aGUgZW5naW5lLlxyXG4gICAgKiBAcGFyYW0ge3JvdXRpbmVDYWxsYmFja30gY2FsbGJhY2tcclxuICAgICovXHJcbiAgICByZWdpc3RlclVwZGF0ZUNhbGxiYWNrKGdhbWVPYmplY3QsIHJlZ2lzdGVyQ29sbGlzaW9uQ2hlY2sgPSB0cnVlKSB7XHJcbiAgICAgICAgaWYoIUdhbWVPYmplY3QpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRW5naW5lLnJlZ2lzdGVyVXBkYXRlQ2FsbGJhY2s6IEdhbWVPYmplY3QgY2xhc3MgaXMgbm90IGRlZmluZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoIShnYW1lT2JqZWN0IGluc3RhbmNlb2YgR2FtZU9iamVjdCkpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRW5naW5lLnJlZ2lzdGVyVXBkYXRlQ2FsbGJhY2s6IGdhbWVPYmplY3QgaXMgbm90IGFuIGluc3RhbmNlIG9mIEdhbWVPYmplY3QuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmdhbWVPYmplY3RTZXQuYWRkKGdhbWVPYmplY3QpO1xyXG5cclxuICAgICAgICAgICAgaWYocmVnaXN0ZXJDb2xsaXNpb25DaGVjaykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb2xsaXNpb25DYW5kaWRhdGVTZXQuYWRkKGdhbWVPYmplY3QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlZ2lzdGVyQ29sbGlzaW9uQ2FuZGlkYXRlKGdhbWVPYmplY3QpIHtcclxuICAgICAgICBpZighR2FtZU9iamVjdCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFbmdpbmUucmVnaXN0ZXJVcGRhdGVDYWxsYmFjazogR2FtZU9iamVjdCBjbGFzcyBpcyBub3QgZGVmaW5lZC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZighKGdhbWVPYmplY3QgaW5zdGFuY2VvZiBHYW1lT2JqZWN0KSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFbmdpbmUucmVnaXN0ZXJVcGRhdGVDYWxsYmFjazogZ2FtZU9iamVjdCBpcyBub3QgYW4gaW5zdGFuY2Ugb2YgR2FtZU9iamVjdC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sbGlzaW9uQ2FuZGlkYXRlU2V0LmFkZChnYW1lT2JqZWN0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdW5yZWdpc3RlckdhbWVPYmplY3QoZ2FtZU9iamVjdCkge1xyXG4gICAgICAgIGlmKCFHYW1lT2JqZWN0KSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0VuZ2luZS5yZWdpc3RlclVwZGF0ZUNhbGxiYWNrOiBHYW1lT2JqZWN0IGNsYXNzIGlzIG5vdCBkZWZpbmVkLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKCEoZ2FtZU9iamVjdCBpbnN0YW5jZW9mIEdhbWVPYmplY3QpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0VuZ2luZS5yZWdpc3RlclVwZGF0ZUNhbGxiYWNrOiBnYW1lT2JqZWN0IGlzIG5vdCBhbiBpbnN0YW5jZSBvZiBHYW1lT2JqZWN0LicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jb2xsaXNpb25DYW5kaWRhdGVTZXQuZGVsZXRlKGdhbWVPYmplY3QpO1xyXG4gICAgICAgICAgICB0aGlzLmdhbWVPYmplY3RTZXQuZGVsZXRlKGdhbWVPYmplY3QpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZWdpc3RlcktleUV2ZW50Q2FsbGJhY2soY2FsbGJhY2spIHtcclxuICAgICAgICBpZih0eXBlb2YgY2FsbGJhY2sgPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICB0aGlzLmtleUNhbGxiYWNrU2V0LmFkZChjYWxsYmFjayk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFbmdpbmUucmVnaXN0ZXJLZXlFdmVudENhbGxiYWNrOiBjYWxsYmFjayBpcyBub3Qgc2V0IGFzIGEgZnVuY3Rpb24uJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVucmVnaXN0ZXJLZXlFdmVudENhbGxiYWNrKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgaWYodHlwZW9mIGNhbGxiYWNrID09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgdGhpcy5rZXlDYWxsYmFja1NldC5kZWxldGUoY2FsbGJhY2spO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRW5naW5lLnJlZ2lzdGVyS2V5RXZlbnRDYWxsYmFjazogY2FsbGJhY2sgaXMgbm90IHNldCBhcyBhIGZ1bmN0aW9uLicpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZWdpc3Rlck1vdXNlRXZlbnRDYWxsYmFjayhjYWxsYmFjaykge1xyXG4gICAgICAgIGlmKHR5cGVvZiBjYWxsYmFjayA9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VDYWxsYmFja1NldC5hZGQoY2FsbGJhY2spO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRW5naW5lLnJlZ2lzdGVyTW91c2VFdmVudENhbGxiYWNrOiBjYWxsYmFjayBpcyBub3Qgc2V0IGFzIGEgZnVuY3Rpb24uJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVucmVnaXN0ZXJNb3VzZUV2ZW50Q2FsbGJhY2soY2FsbGJhY2spIHtcclxuICAgICAgICBpZih0eXBlb2YgY2FsbGJhY2sgPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlQ2FsbGJhY2tTZXQuZGVsZXRlKGNhbGxiYWNrKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0VuZ2luZS5yZWdpc3Rlck1vdXNlRXZlbnRDYWxsYmFjazogY2FsbGJhY2sgaXMgbm90IHNldCBhcyBhIGZ1bmN0aW9uLicpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCJjb25zdCBmbGF0ID0ge307XHJcbiIsIi8qKlxyXG4qIEBjbGFzc1xyXG4qL1xyXG5jbGFzcyBJbWFnZU9iamVjdCB7XHJcbiAgICAvKipcclxuICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAqL1xyXG4gICAgY29uc3RydWN0b3Ioc3ByaXRlLCBzdWJzY3JpYmVUb1JlbmRlciA9IHRydWUpIHtcclxuICAgICAgICBpZihzcHJpdGUpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRTcHJpdGUoc3ByaXRlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucGl2b3RYID0gMC41O1xyXG4gICAgICAgIHRoaXMucGl2b3RZID0gMC41O1xyXG5cclxuICAgICAgICB0aGlzLnggPSAwO1xyXG4gICAgICAgIHRoaXMueSA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMub3JpZ2luYWxzaXplWCA9IHRoaXMub3JpZ2luYWxzaXplWCB8fCAwO1xyXG4gICAgICAgIHRoaXMub3JpZ2luYWxzaXplWSA9IHRoaXMub3JpZ2luYWxzaXplWSB8fCAwO1xyXG5cclxuICAgICAgICB0aGlzLnNjYWxlWCA9IDE7XHJcbiAgICAgICAgdGhpcy5zY2FsZVkgPSAxO1xyXG5cclxuICAgICAgICB0aGlzLmxheWVyID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgaWYoIVJlbmRlcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdJbWFnZU9iamVjdC5jb25zdHJ1Y3RvcjogUmVuZGVyIGNsYXNzIGlzIG5vdCBkZWZpbmVkLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKCEoUmVuZGVyLmluc3RhbmNlIGluc3RhbmNlb2YgUmVuZGVyKSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdJbWFnZU9iamVjdC5jb25zdHJ1Y3RvcjogVGhlcmUgaXMgbm8gcmVuZGVyIGluc3RhbmNlIHRvIHN1YnNjcmlicmUgdG8uJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlciA9IFJlbmRlci5pbnN0YW5jZTtcclxuICAgICAgICAgICAgaWYoc3Vic2NyaWJlVG9SZW5kZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlVG9SZW5kZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXQgcGl2b3QoKSB7XHJcbiAgICAgICAgcmV0dXJuIFt0aGlzLnBpdm90WCwgdGhpcy5waXZvdFldO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBwaXZvdChwaXZvdCkge1xyXG4gICAgICAgIGlmKCAocGl2b3QgaW5zdGFuY2VvZiBBcnJheSkgJiYgKHBpdm90Lmxlbmd0aCA9PSAyKSAmJiAodHlwZW9mIHBpdm90WzBdID09ICdudW1iZXInKSAmJiAodHlwZW9mIHBpdm90WzFdID09ICdudW1iZXInKSApIHtcclxuICAgICAgICAgICAgdGhpcy5waXZvdFggPSBwaXZvdFswXTtcclxuICAgICAgICAgICAgdGhpcy5waXZvdFkgPSBwaXZvdFsxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3NldCBJbWFnZU9iamVjdC5waXZvdDogcGl2b3QgaXMgbm90IGFuIGFycmF5IG9mIHNpemUgMiB0aGF0IGNvbnRhaW5zIG51bWJlcnMuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldCBwb3NpdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gW3RoaXMueCwgdGhpcy55XTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgcG9zaXRpb24ocG9zaXRpb24pIHtcclxuICAgICAgICBpZiggKHBvc2l0aW9uIGluc3RhbmNlb2YgQXJyYXkpICYmIChwb3NpdGlvbi5sZW5ndGggPT0gMikgJiYgKHR5cGVvZiBwb3NpdGlvblswXSA9PSAnbnVtYmVyJykgJiYgKHR5cGVvZiBwb3NpdGlvblsxXSA9PSAnbnVtYmVyJykgKSB7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IHBvc2l0aW9uWzBdO1xyXG4gICAgICAgICAgICB0aGlzLnkgPSBwb3NpdGlvblsxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3NldCBJbWFnZU9iamVjdC5wb3NpdGlvbjogcG9zaXRpb24gaXMgbm90IGFuIGFycmF5IG9mIHNpemUgMiB0aGF0IGNvbnRhaW5zIG51bWJlcnMuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldCBzaXplWCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vcmlnaW5hbHNpemVYKnRoaXMuc2NhbGVYO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBzaXplWSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vcmlnaW5hbHNpemVZKnRoaXMuc2NhbGVZO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBzaXplKCkge1xyXG4gICAgICAgIHJldHVybiBbdGhpcy5vcmlnaW5hbHNpemVYKnRoaXMuc2NhbGVYLCB0aGlzLm9yaWdpbmFsc2l6ZVkqdGhpcy5zY2FsZVldO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBvcmlnaW5hbHNpemUoKSB7XHJcbiAgICAgICAgcmV0dXJuIFt0aGlzLm9yaWdpbmFsc2l6ZVgsIHRoaXMub3JpZ2luYWxzaXplWV07XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IG9yaWdpbmFsc2l6ZShvcmlnaW5hbHNpemUpIHtcclxuICAgICAgICBpZiggKG9yaWdpbmFsc2l6ZSBpbnN0YW5jZW9mIEFycmF5KSAmJiAob3JpZ2luYWxzaXplLmxlbmd0aCA9PSAyKSAmJiAodHlwZW9mIG9yaWdpbmFsc2l6ZVswXSA9PSAnbnVtYmVyJykgJiYgKHR5cGVvZiBvcmlnaW5hbHNpemVbMV0gPT0gJ251bWJlcicpICkge1xyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsc2l6ZVggPSBvcmlnaW5hbHNpemVbMF07XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxzaXplWSA9IG9yaWdpbmFsc2l6ZVsxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3NldCBJbWFnZU9iamVjdC5vcmlnaW5hbHNpemU6IG9yaWdpbmFsc2l6ZSBpcyBub3QgYW4gYXJyYXkgb2Ygc2l6ZSAyIHRoYXQgY29udGFpbnMgbnVtYmVycy4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHNjYWxlKCkge1xyXG4gICAgICAgIHJldHVybiBbdGhpcy5zY2FsZVgsIHRoaXMuc2NhbGVZXTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgc2NhbGUoc2NhbGUpIHtcclxuICAgICAgICBpZiggKHNjYWxlIGluc3RhbmNlb2YgQXJyYXkpICYmIChzY2FsZS5sZW5ndGggPT0gMikgJiYgKHR5cGVvZiBzY2FsZVswXSA9PSAnbnVtYmVyJykgJiYgKHR5cGVvZiBzY2FsZVsxXSA9PSAnbnVtYmVyJykgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NhbGVYID0gc2NhbGVbMF07XHJcbiAgICAgICAgICAgIHRoaXMuc2NhbGVZID0gc2NhbGVbMV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYodHlwZW9mIHNjYWxlID09ICdudW1iZXInKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NhbGVYID0gc2NhbGU7XHJcbiAgICAgICAgICAgIHRoaXMuc2NhbGVZID0gc2NhbGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdzZXQgSW1hZ2VPYmplY3Quc2NhbGU6IHNjYWxlIGlzIG5vdCBhbiBhcnJheSBvZiBzaXplIDIgdGhhdCBjb250YWlucyBudW1iZXJzIG9yIHNpbXBseSBhIG51bWJlci4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbWF5UmVuZGVyKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5zcHJpdGUgaW5zdGFuY2VvZiBJbWFnZSkgJiYgdGhpcy52aXNpYmxlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFNwcml0ZShzcHJpdGUsIGFkanVzdFNpemUgPSB0cnVlKSB7XHJcbiAgICAgICAgaWYoc3ByaXRlIGluc3RhbmNlb2YgSW1hZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5zcHJpdGUgPSBzcHJpdGU7XHJcblxyXG4gICAgICAgICAgICBpZihhZGp1c3RTaXplKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsc2l6ZVggPSBzcHJpdGUubmF0dXJhbFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbHNpemVZID0gc3ByaXRlLm5hdHVyYWxIZWlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZihzcHJpdGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignR2FtZU9iamVjdC5jb25zdHJ1Y3Rvcjogc3ByaXRlIGlzIG5vdCBzZXQgYXMgYSBJbWFnZSBvYmplY3QuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNwcml0ZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHN1YnNjcmliZVRvUmVuZGVyKCkge1xyXG4gICAgICAgIHRoaXMucmVuZGVyLnJlZ2lzdGVyT2JqZWN0KHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHVuc3Vic2NyaWJlVG9SZW5kZXIoKSB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIudW5yZWdpc3Rlck9iamVjdCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVDb3B5KCkge1xyXG4gICAgICAgIGNvbnN0IG5ld0NvcHkgPSBuZXcgSW1hZ2VPYmplY3QodGhpcy5zcHJpdGUsIGZhbHNlKTtcclxuXHJcbiAgICAgICAgdGhpcy5jb3B5UHJvcGVydGllc1RvKG5ld0NvcHkpO1xyXG5cclxuICAgICAgICByZXR1cm4gbmV3Q29weTtcclxuICAgIH1cclxuXHJcbiAgICBjb3B5UHJvcGVydGllc1RvKHRhcmdldEltYWdlT2JqZWN0KSB7XHJcbiAgICAgICAgaWYoKHRhcmdldEltYWdlT2JqZWN0IGluc3RhbmNlb2YgSW1hZ2VPYmplY3QpKSB7XHJcbiAgICAgICAgICAgIHRhcmdldEltYWdlT2JqZWN0LnNwcml0ZSA9IHRoaXMuc3ByaXRlO1xyXG5cclxuICAgICAgICAgICAgdGFyZ2V0SW1hZ2VPYmplY3QucGl2b3QgPSBbdGhpcy5waXZvdFgsIHRoaXMucGl2b3RZXTtcclxuICAgICAgICAgICAgdGFyZ2V0SW1hZ2VPYmplY3QucG9zaXRpb24gPSBbdGhpcy54LCB0aGlzLnldO1xyXG5cclxuICAgICAgICAgICAgdGFyZ2V0SW1hZ2VPYmplY3Qub3JpZ2luYWxzaXplID0gW3RoaXMub3JpZ2luYWxzaXplWCwgdGhpcy5vcmlnaW5hbHNpemVZXTtcclxuXHJcbiAgICAgICAgICAgIHRhcmdldEltYWdlT2JqZWN0LnNjYWxlID0gW3RoaXMuc2NhbGVYLCB0aGlzLnNjYWxlWV07XHJcblxyXG4gICAgICAgICAgICB0YXJnZXRJbWFnZU9iamVjdC5sYXllciA9IHRoaXMubGF5ZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdJbWFnZU9iamVjdC5jb3B5UHJvcGVydGllc1RvOiB0YXJnZXRJbWFnZU9iamVjdCBpcyBub3QgYSBJbWFnZU9iamVjdCBpbnN0YW5jZS4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4qIEBjbGFzc1xyXG4qL1xyXG5jbGFzcyBHYW1lT2JqZWN0IGV4dGVuZHMgSW1hZ2VPYmplY3Qge1xyXG4gICAgLyoqXHJcbiAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHNwcml0ZSwgc3Vic2NyaWJlVG9SZW5kZXIgPSB0cnVlLCBzdWJzY3JpYnJlVG9FbmdpbmUgPSB0cnVlKSB7XHJcbiAgICAgICAgc3VwZXIoc3ByaXRlLCBzdWJzY3JpYmVUb1JlbmRlcik7XHJcblxyXG4gICAgICAgIHRoaXMudnggPSAwO1xyXG4gICAgICAgIHRoaXMudnkgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLm9yaWdpbmFsQm9yZGVyV2lkdGggPSB0aGlzLm9yaWdpbmFsc2l6ZVggfHwgNjQ7XHJcbiAgICAgICAgdGhpcy5vcmlnaW5hbEJvcmRlckhlaWdodCA9IHRoaXMub3JpZ2luYWxzaXplWSB8fCA2NDtcclxuXHJcbiAgICAgICAgdGhpcy53YWxrYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZHluYW1pYyA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnN0ZXAgPSBbMCwgMF07XHJcblxyXG4gICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgaWYoIUVuZ2luZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdHYW1lT2JqZWN0LmNvbnN0cnVjdG9yOiBFbmdpbmUgY2xhc3MgaXMgbm90IGRlZmluZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoIShFbmdpbmUuaW5zdGFuY2UgaW5zdGFuY2VvZiBFbmdpbmUpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0dhbWVPYmplY3QuY29uc3RydWN0b3I6IFRoZXJlIGlzIG5vIEVuZ2luZSBpbnN0YW5jZSB0byBzdWJzY3JpYnJlIHRvLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5lbmdpbmUgPSBFbmdpbmUuaW5zdGFuY2U7XHJcblxyXG4gICAgICAgICAgICBpZihzdWJzY3JpYnJlVG9FbmdpbmUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJyZVRvRW5naW5lKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc3Vic2NyaWJyZVRvRW5naW5lKCkge1xyXG4gICAgICAgIHRoaXMuZW5naW5lLnJlZ2lzdGVyQ29sbGlzaW9uQ2FuZGlkYXRlKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHVuc3Vic2NyaWJyZVRvRW5naW5lKCkge1xyXG4gICAgICAgIHRoaXMuZW5naW5lLnVucmVnaXN0ZXJHYW1lT2JqZWN0KHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIG1heVJlbmRlcigpIHtcclxuICAgICAgICByZXR1cm4gc3VwZXIubWF5UmVuZGVyKCkgJiYgdGhpcy5hY3RpdmU7XHJcbiAgICB9XHJcblxyXG4gICAgZWFybHlVcGRhdGUoZGVsdGFUaW1lKSB7XHJcbiAgICAgICAgdGhpcy5zdGVwWzBdID0gdGhpcy52eCpkZWx0YVRpbWU7XHJcbiAgICAgICAgdGhpcy5zdGVwWzFdID0gdGhpcy52eSpkZWx0YVRpbWU7XHJcbiAgICB9XHJcblxyXG4gICAgbGF0ZVVwZGF0ZSgpIHtcclxuICAgICAgICB0aGlzLnggKz0gdGhpcy5zdGVwWzBdO1xyXG4gICAgICAgIHRoaXMueSArPSB0aGlzLnN0ZXBbMV07XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGJvcmRlcldpZHRoKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm9yaWdpbmFsQm9yZGVyV2lkdGgqdGhpcy5zY2FsZVg7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGJvcmRlckhlaWdodCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vcmlnaW5hbEJvcmRlckhlaWdodCp0aGlzLnNjYWxlWTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgb3JpZ2luYWxCb3JkZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIFt0aGlzLm9yaWdpbmFsQm9yZGVyV2lkdGgsIHRoaXMub3JpZ2luYWxCb3JkZXJIZWlnaHRdO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBvcmlnaW5hbEJvcmRlcihvcmlnaW5hbEJvcmRlcikge1xyXG4gICAgICAgIGlmKCAob3JpZ2luYWxCb3JkZXIgaW5zdGFuY2VvZiBBcnJheSkgJiYgKG9yaWdpbmFsQm9yZGVyLmxlbmd0aCA9PSAyKSAmJiAodHlwZW9mIG9yaWdpbmFsQm9yZGVyWzBdID09ICdudW1iZXInKSAmJiAodHlwZW9mIG9yaWdpbmFsQm9yZGVyWzFdID09ICdudW1iZXInKSApIHtcclxuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbEJvcmRlcldpZHRoID0gb3JpZ2luYWxCb3JkZXJbMF07XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxCb3JkZXJIZWlnaHQgPSBvcmlnaW5hbEJvcmRlclsxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3NldCBJbWFnZU9iamVjdC5vcmlnaW5hbEJvcmRlcjogb3JpZ2luYWxCb3JkZXIgaXMgbm90IGFuIGFycmF5IG9mIHNpemUgMiB0aGF0IGNvbnRhaW5zIG51bWJlcnMuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldCBib3JkZXIoKSB7XHJcbiAgICAgICAgY29uc3QgYm9yZGVyUmFkaXVzID0gWysgMC41KnRoaXMub3JpZ2luYWxCb3JkZXJXaWR0aCp0aGlzLnNjYWxlWCwgMC41KnRoaXMub3JpZ2luYWxCb3JkZXJIZWlnaHQqdGhpcy5zY2FsZVldO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0b3A6IHRoaXMueSArIGJvcmRlclJhZGl1c1sxXSxcclxuICAgICAgICAgICAgcmlnaHQ6IHRoaXMueCArIGJvcmRlclJhZGl1c1swXSxcclxuICAgICAgICAgICAgYm90dG9tOiB0aGlzLnkgLSBib3JkZXJSYWRpdXNbMV0sXHJcbiAgICAgICAgICAgIGxlZnQ6IHRoaXMueCAtIGJvcmRlclJhZGl1c1swXVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgaGFzQ29sbGlkZWQob3RoZXJCb3JkZXIpIHtcclxuICAgICAgICBjb25zdCBteUJvcmRlciA9IHRoaXMuYm9yZGVyO1xyXG5cclxuICAgICAgICByZXR1cm4gKE1hdGgubWluKG15Qm9yZGVyLnJpZ2h0LCBvdGhlckJvcmRlci5yaWdodCkgLSBNYXRoLm1heChteUJvcmRlci5sZWZ0LCBvdGhlckJvcmRlci5sZWZ0KSA+PSAwKSAmJiAoTWF0aC5taW4obXlCb3JkZXIudG9wLCBvdGhlckJvcmRlci50b3ApIC0gTWF0aC5tYXgobXlCb3JkZXIuYm90dG9tLCBvdGhlckJvcmRlci5ib3R0b20pID49IDApO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ29sbGlzaW9uKG90aGVyR2FtZU9iamVjdCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVDb3B5KCkge1xyXG4gICAgICAgIGNvbnN0IG5ld0NvcHkgPSBuZXcgR2FtZU9iamVjdCh0aGlzLnNwcml0ZSwgZmFsc2UpO1xyXG5cclxuICAgICAgICB0aGlzLmNvcHlQcm9wZXJ0aWVzVG8obmV3Q29weSk7XHJcblxyXG4gICAgICAgIHJldHVybiBuZXdDb3B5O1xyXG4gICAgfVxyXG5cclxuICAgIGNvcHlQcm9wZXJ0aWVzVG8odGFyZ2V0R2FtZU9iamVjdCkge1xyXG4gICAgICAgIGlmKCh0YXJnZXRHYW1lT2JqZWN0IGluc3RhbmNlb2YgR2FtZU9iamVjdCkpIHtcclxuICAgICAgICAgICAgc3VwZXIuY29weVByb3BlcnRpZXNUbyh0YXJnZXRHYW1lT2JqZWN0KTtcclxuXHJcbiAgICAgICAgICAgIHRhcmdldEdhbWVPYmplY3QudnggPSB0aGlzLnZ4O1xyXG4gICAgICAgICAgICB0YXJnZXRHYW1lT2JqZWN0LnZ5ID0gdGhpcy52eTtcclxuXHJcbiAgICAgICAgICAgIHRhcmdldEdhbWVPYmplY3Qub3JpZ2luYWxCb3JkZXJXaWR0aCA9IHRoaXMub3JpZ2luYWxCb3JkZXJXaWR0aDtcclxuICAgICAgICAgICAgdGFyZ2V0R2FtZU9iamVjdC5vcmlnaW5hbEJvcmRlckhlaWdodCA9IHRoaXMub3JpZ2luYWxCb3JkZXJIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdHYW1lT2JqZWN0LmNvcHlQcm9wZXJ0aWVzVG86IHRhcmdldEdhbWVPYmplY3QgaXMgbm90IGEgR2FtZU9iamVjdCBpbnN0YW5jZS4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4qIEBjbGFzc1xyXG4qL1xyXG5jbGFzcyBQbGF5ZXIgZXh0ZW5kcyBHYW1lT2JqZWN0IHtcclxuICAgIC8qKlxyXG4gICAgKiBAY29uc3RydWN0b3JcclxuICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBzcHJpdGUsXHJcbiAgICAgICAgc3Vic2NyaWJlVG9FbmdpbmUgPSB0cnVlLFxyXG4gICAgICAgIHN1YnNjcmliZVRvUmVuZGVyID0gdHJ1ZSxcclxuICAgICAgICB1cEtleXMgPSBbODcsIDM4XSxcclxuICAgICAgICByaWdodEtleXMgPSBbNjgsIDM5XSxcclxuICAgICAgICBkb3duS2V5cyA9IFs4MywgNDBdLFxyXG4gICAgICAgIGxlZnRLZXlzID0gWzY1LCAzN11cclxuICAgICkge1xyXG4gICAgICAgIHN1cGVyKHNwcml0ZSwgc3Vic2NyaWJlVG9SZW5kZXIsIHN1YnNjcmliZVRvRW5naW5lKTtcclxuXHJcbiAgICAgICAgdGhpcy5rZXlNYXAgPSBuZXcgTWFwKCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0S2V5TWFwKHVwS2V5cywgJ3VwJyk7XHJcbiAgICAgICAgdGhpcy5zZXRLZXlNYXAocmlnaHRLZXlzLCAncmlnaHQnKTtcclxuICAgICAgICB0aGlzLnNldEtleU1hcChkb3duS2V5cywgJ2Rvd24nKTtcclxuICAgICAgICB0aGlzLnNldEtleU1hcChsZWZ0S2V5cywgJ2xlZnQnKTtcclxuXHJcbiAgICAgICAgdGhpcy5sYXN0QWN0aW9uID0gJ25vbmUnO1xyXG5cclxuICAgICAgICB0aGlzLm1vdmVTcGVlZCA9IDIwMDtcclxuXHJcbiAgICAgICAgdGhpcy53YWxrYWJsZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5keW5hbWljID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRLZXlNYXAoa2V5cywgYWN0aW9uKSB7XHJcbiAgICAgICAgZm9yKGNvbnN0IGtleSBvZiBrZXlzKSB7XHJcbiAgICAgICAgICAgIHRoaXMua2V5TWFwLnNldChrZXksIGFjdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHN1YnNjcmlicmVUb0VuZ2luZSgpIHtcclxuICAgICAgICB0aGlzLmVuZ2luZS5yZWdpc3RlcktleUV2ZW50Q2FsbGJhY2sodGhpcy5oYW5kbGVLZXlFdmVudHMuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5lbmdpbmUucmVnaXN0ZXJVcGRhdGVDYWxsYmFjayh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICB1bnN1YnNjcmlicmVUb0VuZ2luZSgpIHtcclxuICAgICAgICBzdXBlci51bnN1YnNjcmlicmVUb0VuZ2luZSgpO1xyXG4gICAgICAgIHRoaXMuZW5naW5lLnVucmVnaXN0ZXJLZXlFdmVudENhbGxiYWNrKHRoaXMuaGFuZGxlS2V5RXZlbnRzKTtcclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVLZXlFdmVudHMoZXZlbnQpIHtcclxuICAgICAgICBpZihldmVudC5rZXlDb2RlICYmIHRoaXMua2V5TWFwLmhhcyhldmVudC5rZXlDb2RlKSkge1xyXG4gICAgICAgICAgICBsZXQgYWN0aW9uID0gdGhpcy5rZXlNYXAuZ2V0KGV2ZW50LmtleUNvZGUpO1xyXG5cclxuICAgICAgICAgICAgaWYoZXZlbnQudHlwZSA9PSAna2V5dXAnKSB7XHJcbiAgICAgICAgICAgICAgICBhY3Rpb24gKz0gJ0NhbmNlbCc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMucGVyZm9ybUFjdGlvbihhY3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbkNvbGxpc2lvbkNoZWNrKG90aGVyR2FtZU9iamVjdCkge1xyXG4gICAgICAgIGlmKCFvdGhlckdhbWVPYmplY3Qud2Fsa2FibGUpIHtcclxuICAgICAgICAgICAgbGV0IG15Qm9yZGVyO1xyXG4gICAgICAgICAgICBjb25zdCB0YXJnZXRCb3JkZXIgPSBvdGhlckdhbWVPYmplY3QuYm9yZGVyO1xyXG5cclxuICAgICAgICAgICAgaWYodGhpcy5zdGVwWzBdICE9IDApIHtcclxuICAgICAgICAgICAgICAgIG15Qm9yZGVyID0gdGhpcy5ib3JkZXI7XHJcbiAgICAgICAgICAgICAgICBteUJvcmRlci5sZWZ0ICs9IHRoaXMuc3RlcFswXTtcclxuICAgICAgICAgICAgICAgIG15Qm9yZGVyLnJpZ2h0ICs9IHRoaXMuc3RlcFswXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihvdGhlckdhbWVPYmplY3QuaGFzQ29sbGlkZWQobXlCb3JkZXIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5zdGVwWzBdID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0ZXBbMF0gKz0gdGFyZ2V0Qm9yZGVyLmxlZnQgLSBteUJvcmRlci5yaWdodCAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0ZXBbMF0gKz0gdGFyZ2V0Qm9yZGVyLnJpZ2h0IC0gbXlCb3JkZXIubGVmdCArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZih0aGlzLnN0ZXBbMV0gIT0gMCkge1xyXG4gICAgICAgICAgICAgICAgbXlCb3JkZXIgPSB0aGlzLmJvcmRlcjtcclxuICAgICAgICAgICAgICAgIG15Qm9yZGVyLnRvcCArPSB0aGlzLnN0ZXBbMV07XHJcbiAgICAgICAgICAgICAgICBteUJvcmRlci5ib3R0b20gKz0gdGhpcy5zdGVwWzFdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKG90aGVyR2FtZU9iamVjdC5oYXNDb2xsaWRlZChteUJvcmRlcikpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnN0ZXBbMV0gPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RlcFsxXSArPSB0YXJnZXRCb3JkZXIuYm90dG9tIC0gbXlCb3JkZXIudG9wIC0gMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RlcFsxXSArPSB0YXJnZXRCb3JkZXIudG9wIC0gbXlCb3JkZXIuYm90dG9tICsgMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcGVyZm9ybUFjdGlvbihhY3Rpb24gPSAnbm9uZScpIHtcclxuICAgICAgICBpZih0aGlzLmFjdGl2ZSAmJiAodGhpcy5sYXN0QWN0aW9uICE9IGFjdGlvbikpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChhY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3VwJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZ5ID0gdGhpcy5tb3ZlU3BlZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd1cENhbmNlbCc6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy52eSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52eSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncmlnaHQnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudnggPSB0aGlzLm1vdmVTcGVlZDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3JpZ2h0Q2FuY2VsJzpcclxuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnZ4ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZ4ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkb3duJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZ5ID0gLXRoaXMubW92ZVNwZWVkO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZG93bkNhbmNlbCc6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy52eSA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52eSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnbGVmdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52eCA9IC10aGlzLm1vdmVTcGVlZDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2xlZnRDYW5jZWwnOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMudnggPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudnggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ25vbmUnOlxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5sYXN0QWN0aW9uID0gYWN0aW9uO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCJjbGFzcyBSZW5kZXIge1xyXG4gICAgY29uc3RydWN0b3IoY2FudmFzKSB7XHJcbiAgICAgICAgaWYoUmVuZGVyLmluc3RhbmNlIGluc3RhbmNlb2YgUmVuZGVyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlbmRlci5jb25zdHJ1Y3RvcjogUmVuZGVyIGluc3RhbmNlIGFscmVhZHkgZXhpc3RzLicpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCEoY2FudmFzIGluc3RhbmNlb2YgSFRNTENhbnZhc0VsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJSZW5kZXIuY29uc3RydWN0b3I6IGdpdmVuIGNhbnZhcyBvYmplY3QgaXMgbm90IGFuIEhUTUxDYW52YXNFbGVtZW50LlwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBSZW5kZXIuaW5zdGFuY2UgPSB0aGlzO1xyXG5cclxuICAgICAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcztcclxuICAgICAgICB0aGlzLmNvbnRleHQyRCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlQ2FudmFzU2l6ZSgpO1xyXG5cclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy51cGRhdGVDYW52YXNTaXplKTtcclxuXHJcbiAgICAgICAgLy8gQ29vcmRpbmF0ZSBzeXRlbS4gQXhpcyBvcmllbnRhdGlvbiB3aWxsIGJlOiBYLT5yaWdodCAsIFktPnVwXHJcbiAgICAgICAgdGhpcy5vcmlnaW5YID0gMC41O1xyXG4gICAgICAgIHRoaXMub3JpZ2luWSA9IDAuNTtcclxuXHJcbiAgICAgICAgdGhpcy5jb29yZE9mZnNldFggPSAwO1xyXG4gICAgICAgIHRoaXMuY29vcmRPZmZzZXRZID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5vYmplY3RTZXQgPSBuZXcgU2V0KCk7XHJcblxyXG4gICAgICAgIHRoaXMuZHJhd1RpbGVHcmlkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5kcmF3Qm9yZGVycyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZHJhd1RpbGVIaWdobGlnaHQgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBjYW52YXNQb3NpdGlvblRvUmVuZGVyQ29vcmRpbmF0ZXMocG9zaXRpb24pIHtcclxuICAgICAgICBpZiggKHBvc2l0aW9uIGluc3RhbmNlb2YgQXJyYXkpICYmIChwb3NpdGlvbi5sZW5ndGggPT0gMikgJiYgKHR5cGVvZiBwb3NpdGlvblswXSA9PSAnbnVtYmVyJykgJiYgKHR5cGVvZiBwb3NpdGlvblsxXSA9PSAnbnVtYmVyJykgKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlYWxPcmlnaW4gPSB0aGlzLnJlYWxPcmlnaW47XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb25bMF0gLSByZWFsT3JpZ2luWzBdLFxyXG4gICAgICAgICAgICAgICAgcmVhbE9yaWdpblsxXSAtIHBvc2l0aW9uWzFdXHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdzZXQgUmVuZGVyLmNhbnZhc1Bvc2l0aW9uVG9SZW5kZXJDb29yZGluYXRlczogcG9zaXRpb24gaXMgbm90IGFuIGFycmF5IG9mIHNpemUgMiB0aGF0IGNvbnRhaW5zIG51bWJlcnMuJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZVBvc2l0aW9uVG9DYW52YXNSZWxhdGl2ZVBvc2l0aW9uKG1vdXNlUG9zaXRpb24pIHtcclxuICAgICAgICBjb25zdCBjYW52YXNSZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIG1vdXNlUG9zaXRpb25bMF0gLSBjYW52YXNSZWN0LmxlZnQsXHJcbiAgICAgICAgICAgIG1vdXNlUG9zaXRpb25bMV0gLSBjYW52YXNSZWN0LnRvcFxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcblxyXG4gICAgbW91c2VQb3NpdGlvblRvUmVuZGVyQ29vcmRpbmF0ZXMobW91c2VQb3NpdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNhbnZhc1Bvc2l0aW9uVG9SZW5kZXJDb29yZGluYXRlcyh0aGlzLm1vdXNlUG9zaXRpb25Ub0NhbnZhc1JlbGF0aXZlUG9zaXRpb24obW91c2VQb3NpdGlvbikpO1xyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlUG9zaXRpb25Ub1RpbGVDb29yZGluYXRlcyhtb3VzZVBvc2l0aW9uKSB7XHJcbiAgICAgICAgaWYoIVRlcnJhaW4pIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignUmVuZGVyLm1vdXNlUG9zaXRpb25Ub1RpbGVDb29yZGluYXRlczogVGVycmFpbiBjbGFzcyBpcyBub3QgZGVmaW5lZC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZighKHRoaXMudGVycmFpbiBpbnN0YW5jZW9mIFRlcnJhaW4pKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlbmRlci5tb3VzZVBvc2l0aW9uVG9UaWxlQ29vcmRpbmF0ZXM6IHRlcnJhaW4gaXMgbm90IHNldC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlYWxPcmlnaW4gPSB0aGlzLnJlYWxPcmlnaW47XHJcbiAgICAgICAgICAgIGNvbnN0IHJlbGF0aXZlQ2FudmFzUG9zaXRpb24gPSB0aGlzLm1vdXNlUG9zaXRpb25Ub0NhbnZhc1JlbGF0aXZlUG9zaXRpb24obW91c2VQb3NpdGlvbik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBjb29yZGluYXRlcyA9IFtcclxuICAgICAgICAgICAgICAgIDAuNSArIChyZWxhdGl2ZUNhbnZhc1Bvc2l0aW9uWzBdIC0gcmVhbE9yaWdpblswXSkvdGhpcy50ZXJyYWluLnRpbGVTaXplWCxcclxuICAgICAgICAgICAgICAgIC0wLjUgKyAocmVhbE9yaWdpblsxXSAtIHJlbGF0aXZlQ2FudmFzUG9zaXRpb25bMV0pL3RoaXMudGVycmFpbi50aWxlU2l6ZVlcclxuICAgICAgICAgICAgXTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICBNYXRoLmZsb29yKGNvb3JkaW5hdGVzWzBdKSxcclxuICAgICAgICAgICAgICAgIE1hdGguY2VpbChjb29yZGluYXRlc1sxXSlcclxuICAgICAgICAgICAgXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IG9yaWdpbigpIHtcclxuICAgICAgICByZXR1cm4gW3RoaXMub3JpZ2luWCwgdGhpcy5vcmlnaW5ZXTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgb3JpZ2luKG9yaWdpbikge1xyXG4gICAgICAgIGlmKCAob3JpZ2luIGluc3RhbmNlb2YgQXJyYXkpICYmIChvcmlnaW4ubGVuZ3RoID09IDIpICYmICh0eXBlb2Ygb3JpZ2luWzBdID09ICdudW1iZXInKSAmJiAodHlwZW9mIG9yaWdpblsxXSA9PSAnbnVtYmVyJykgKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luWCA9IG9yaWdpblswXTtcclxuICAgICAgICAgICAgdGhpcy5vcmlnaW5ZID0gb3JpZ2luWzFdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignc2V0IFJlbmRlci5vcmlnaW46IG9yaWdpbiBpcyBub3QgYW4gYXJyYXkgb2Ygc2l6ZSAyIHRoYXQgY29udGFpbnMgbnVtYmVycy4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGNvb3JkT2Zmc2V0KCkge1xyXG4gICAgICAgIHJldHVybiBbdGhpcy5jb29yZE9mZnNldFgsIHRoaXMuY29vcmRPZmZzZXRZXTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgY29vcmRPZmZzZXQoY29vcmRPZmZzZXQpIHtcclxuICAgICAgICBpZiggKGNvb3JkT2Zmc2V0IGluc3RhbmNlb2YgQXJyYXkpICYmIChjb29yZE9mZnNldC5sZW5ndGggPT0gMikgJiYgKHR5cGVvZiBjb29yZE9mZnNldFswXSA9PSAnbnVtYmVyJykgJiYgKHR5cGVvZiBjb29yZE9mZnNldFsxXSA9PSAnbnVtYmVyJykgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29vcmRPZmZzZXRYID0gY29vcmRPZmZzZXRbMF0udG9GaXhlZCgpO1xyXG4gICAgICAgICAgICB0aGlzLmNvb3JkT2Zmc2V0WSA9IGNvb3JkT2Zmc2V0WzFdLnRvRml4ZWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3NldCBSZW5kZXIuY29vcmRPZmZzZXQ6IGNvb3JkT2Zmc2V0IGlzIG5vdCBhbiBhcnJheSBvZiBzaXplIDIgdGhhdCBjb250YWlucyBudW1iZXJzLicpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXQgcmVhbE9yaWdpbigpIHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICB0aGlzLm9yaWdpblgqdGhpcy5jYW52YXMud2lkdGggKyB0aGlzLmNvb3JkT2Zmc2V0WCxcclxuICAgICAgICAgICAgKDEgLSB0aGlzLm9yaWdpblkpKnRoaXMuY2FudmFzLmhlaWdodCAtIHRoaXMuY29vcmRPZmZzZXRZXHJcbiAgICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVDYW52YXNTaXplKCkge1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lclN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5jYW52YXMucGFyZW50RWxlbWVudCk7XHJcblxyXG4gICAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gcGFyc2VGbG9hdChjb250YWluZXJTdHlsZS53aWR0aCkgLSBwYXJzZUZsb2F0KGNvbnRhaW5lclN0eWxlLnBhZGRpbmdMZWZ0KSAtIHBhcnNlRmxvYXQoY29udGFpbmVyU3R5bGUucGFkZGluZ1JpZ2h0KSAtIHBhcnNlRmxvYXQoY29udGFpbmVyU3R5bGUuYm9yZGVyTGVmdFdpZHRoKSAtIHBhcnNlRmxvYXQoY29udGFpbmVyU3R5bGUuYm9yZGVyUmlnaHRXaWR0aCk7XHJcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gcGFyc2VGbG9hdChjb250YWluZXJTdHlsZS5oZWlnaHQpIC0gcGFyc2VGbG9hdChjb250YWluZXJTdHlsZS5wYWRkaW5nVG9wKSAtIHBhcnNlRmxvYXQoY29udGFpbmVyU3R5bGUucGFkZGluZ0JvdHRvbSkgLSBwYXJzZUZsb2F0KGNvbnRhaW5lclN0eWxlLmJvcmRlclRvcFdpZHRoKSAtIHBhcnNlRmxvYXQoY29udGFpbmVyU3R5bGUuYm9yZGVyQm90dG9tV2lkdGgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlZ2lzdGVyT2JqZWN0KGltYWdlT2JqZWN0KSB7XHJcbiAgICAgICAgaWYoIUltYWdlT2JqZWN0KSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlbmRlci5yZWdpc3Rlck9iamVjdDogSW1hZ2VPYmplY3QgY2xhc3MgaXMgbm90IGRlZmluZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoIShpbWFnZU9iamVjdCBpbnN0YW5jZW9mIEltYWdlT2JqZWN0KSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdSZW5kZXIucmVnaXN0ZXJPYmplY3Q6IGltYWdlT2JqZWN0IGlzIG5vdCBhIEltYWdlT2JqZWN0IG9iamVjdC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMub2JqZWN0U2V0LmFkZChpbWFnZU9iamVjdCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVucmVnaXN0ZXJPYmplY3QoaW1hZ2VPYmplY3QpIHtcclxuICAgICAgICBpZighSW1hZ2VPYmplY3QpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignUmVuZGVyLnJlZ2lzdGVyT2JqZWN0OiBJbWFnZU9iamVjdCBjbGFzcyBpcyBub3QgZGVmaW5lZC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZighKGltYWdlT2JqZWN0IGluc3RhbmNlb2YgSW1hZ2VPYmplY3QpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlbmRlci5yZWdpc3Rlck9iamVjdDogaW1hZ2VPYmplY3QgaXMgbm90IGEgSW1hZ2VPYmplY3Qgb2JqZWN0LicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5vYmplY3RTZXQuZGVsZXRlKGltYWdlT2JqZWN0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VGVycmFpbih0ZXJyYWluKSB7XHJcbiAgICAgICAgaWYoIVRlcnJhaW4pIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignUmVuZGVyLnNldFRlcnJhaW46IFRlcnJhaW4gY2xhc3MgaXMgbm90IGRlZmluZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoISh0ZXJyYWluIGluc3RhbmNlb2YgVGVycmFpbikpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignUmVuZGVyLnNldFRlcnJhaW46IHRlcnJhaW4gaXMgbm90IGEgVGVycmFpbiBvYmplY3QuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnRlcnJhaW4gPSB0ZXJyYWluO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0MkQuY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xyXG5cclxuICAgICAgICB0aGlzLnJlbmRlclRlcnJhaW4oKTtcclxuXHJcbiAgICAgICAgaWYodGhpcy5kcmF3VGlsZUdyaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJUaWxlR3JpZCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5yZW5kZXJPYmplY3RzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyVGVycmFpbigpIHtcclxuICAgICAgICBjb25zdCByZWFsT3JpZ2luID0gdGhpcy5yZWFsT3JpZ2luO1xyXG5cclxuICAgICAgICB0aGlzLmNvbnRleHQyRC5maWxsU3R5bGUgPSAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjQpJztcclxuXHJcbiAgICAgICAgaWYodGhpcy50ZXJyYWluKSB7XHJcbiAgICAgICAgICAgIGZvcihjb25zdCB0aWxlIG9mIHRoaXMudGVycmFpbi50aWxlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGlsZVBvc2l0aW9uID0gW1xyXG4gICAgICAgICAgICAgICAgICAgIChyZWFsT3JpZ2luWzBdICsgKHRpbGUucm93IC0gMC41KSp0aGlzLnRlcnJhaW4udGlsZVNpemVYKS50b0ZpeGVkKCksXHJcbiAgICAgICAgICAgICAgICAgICAgKHJlYWxPcmlnaW5bMV0gLSAodGlsZS5jb2x1bW4gKyAwLjUpKnRoaXMudGVycmFpbi50aWxlU2l6ZVkpLnRvRml4ZWQoKVxyXG4gICAgICAgICAgICAgICAgXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZih0aWxlLnNwcml0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dDJELmRyYXdJbWFnZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGlsZS5zcHJpdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbGVQb3NpdGlvblswXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGlsZVBvc2l0aW9uWzFdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAodGhpcy50ZXJyYWluLnRpbGVTaXplWCkudG9GaXhlZCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAodGhpcy50ZXJyYWluLnRpbGVTaXplWSkudG9GaXhlZCgpXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmRyYXdUaWxlSGlnaGxpZ2h0ICYmIHRpbGUuaGlnaGxpZ2h0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQyRC5maWxsUmVjdChcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGlsZVBvc2l0aW9uWzBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aWxlUG9zaXRpb25bMV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnRlcnJhaW4udGlsZVNpemVYKS50b0ZpeGVkKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnRlcnJhaW4udGlsZVNpemVZKS50b0ZpeGVkKClcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlck9iamVjdHMoKSB7XHJcbiAgICAgICAgY29uc3QgcmVhbE9yaWdpbiA9IHRoaXMucmVhbE9yaWdpbjtcclxuXHJcbiAgICAgICAgbGV0IG9iamVjdFNpemUsIG9iamVjdEJvcmRlcjtcclxuXHJcbiAgICAgICAgdGhpcy5jb250ZXh0MkQuc3Ryb2tlU3R5bGUgPSAncHVycGxlJztcclxuICAgICAgICB0aGlzLmNvbnRleHQyRC5saW5lV2lkdGggPSAyO1xyXG5cclxuICAgICAgICBmb3IoY29uc3Qgb2JqZWN0VG9SZW5kZXIgb2YgXy5jaGFpbihbLi4udGhpcy5vYmplY3RTZXRdKS5zb3J0QnkoJ3knKS5yZXZlcnNlKCkuc29ydEJ5KCdsYXllcicpLnZhbHVlKCkpIHtcclxuICAgICAgICAgICAgaWYob2JqZWN0VG9SZW5kZXIubWF5UmVuZGVyKCkpIHtcclxuICAgICAgICAgICAgICAgIG9iamVjdFNpemUgPSBvYmplY3RUb1JlbmRlci5zaXplO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZXh0MkQuZHJhd0ltYWdlKFxyXG4gICAgICAgICAgICAgICAgICAgIG9iamVjdFRvUmVuZGVyLnNwcml0ZSxcclxuICAgICAgICAgICAgICAgICAgICAocmVhbE9yaWdpblswXSArIG9iamVjdFRvUmVuZGVyLnggLSBvYmplY3RUb1JlbmRlci5waXZvdFgqb2JqZWN0U2l6ZVswXSkudG9GaXhlZCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIChyZWFsT3JpZ2luWzFdIC0gKG9iamVjdFRvUmVuZGVyLnkgKyAoMSAtIG9iamVjdFRvUmVuZGVyLnBpdm90WSkqb2JqZWN0U2l6ZVsxXSkpLnRvRml4ZWQoKSxcclxuICAgICAgICAgICAgICAgICAgICAob2JqZWN0U2l6ZVswXSkudG9GaXhlZCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIChvYmplY3RTaXplWzFdKS50b0ZpeGVkKClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKHRoaXMuZHJhd0JvcmRlcnMpIHtcclxuICAgICAgICAgICAgICAgIGlmKCFHYW1lT2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignUmVuZGVyLnJlbmRlck9iamVjdHM6IEdhbWVPYmplY3QgY2xhc3Mgbm90IGRlZmluZWQuJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKChvYmplY3RUb1JlbmRlciBpbnN0YW5jZW9mIEdhbWVPYmplY3QpICYmIG9iamVjdFRvUmVuZGVyLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9iamVjdEJvcmRlciA9IG9iamVjdFRvUmVuZGVyLmJvcmRlcjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQyRC5zdHJva2VSZWN0KHJlYWxPcmlnaW5bMF0gKyBvYmplY3RCb3JkZXIubGVmdCwgcmVhbE9yaWdpblsxXSAtIG9iamVjdEJvcmRlci50b3AsIG9iamVjdFRvUmVuZGVyLmJvcmRlcldpZHRoLCBvYmplY3RUb1JlbmRlci5ib3JkZXJIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlclRpbGVHcmlkKCkge1xyXG4gICAgICAgIGlmKHRoaXMudGVycmFpbikge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQyRC5zdHJva2VTdHlsZSA9ICd3aGl0ZSc7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dDJELmxpbmVXaWR0aCA9IDE7XHJcblxyXG4gICAgICAgICAgICBjb25zdCByZWFsT3JpZ2luID0gdGhpcy5yZWFsT3JpZ2luO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbWluWCA9IE1hdGguY2VpbCgwLjUgLSByZWFsT3JpZ2luWzBdL3RoaXMudGVycmFpbi50aWxlU2l6ZVgpO1xyXG4gICAgICAgICAgICBjb25zdCBtYXhYID0gTWF0aC5mbG9vcigwLjUgKyAodGhpcy5jYW52YXMud2lkdGggLSByZWFsT3JpZ2luWzBdKS90aGlzLnRlcnJhaW4udGlsZVNpemVYKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1pblkgPSBNYXRoLmNlaWwoLTAuNSArIChyZWFsT3JpZ2luWzFdIC0gdGhpcy5jYW52YXMuaGVpZ2h0KS90aGlzLnRlcnJhaW4udGlsZVNpemVZKTtcclxuICAgICAgICAgICAgY29uc3QgbWF4WSA9IE1hdGguZmxvb3IoLTAuNSArIHJlYWxPcmlnaW5bMV0vdGhpcy50ZXJyYWluLnRpbGVTaXplWSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQyRC5iZWdpblBhdGgoKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBsb2Fja2VkUG9zaXRpb24gPSAwO1xyXG5cclxuICAgICAgICAgICAgZm9yKGxldCBpID0gbWluWDsgaSA8PSBtYXhYOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGxvYWNrZWRQb3NpdGlvbiA9IChyZWFsT3JpZ2luWzBdICsgKGkgLSAwLjUpKnRoaXMudGVycmFpbi50aWxlU2l6ZVgpLnRvRml4ZWQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dDJELm1vdmVUbyhsb2Fja2VkUG9zaXRpb24sIDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZXh0MkQubGluZVRvKGxvYWNrZWRQb3NpdGlvbix0aGlzLmNhbnZhcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb3IobGV0IGogPSBtaW5ZOyBqIDw9IG1heFk7IGorKykge1xyXG4gICAgICAgICAgICAgICAgbG9hY2tlZFBvc2l0aW9uID0gKHJlYWxPcmlnaW5bMV0gLSAoaiArIDAuNSkqdGhpcy50ZXJyYWluLnRpbGVTaXplWSkudG9GaXhlZCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZXh0MkQubW92ZVRvKDAsIGxvYWNrZWRQb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQyRC5saW5lVG8odGhpcy5jYW52YXMud2lkdGgsIGxvYWNrZWRQb3NpdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dDJELnN0cm9rZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCJjb25zdCBJbWFnZVJlc291cmNlU3RhdHVzID0ge1xyXG4gICAgSU5JVElBVElORzogJ0luaXRpYXRpbmcnLFxyXG4gICAgRkFJTEVEOiAnRmFpbGVkJyxcclxuICAgIExPQURJTkc6ICdMb2FkaW5nJyxcclxuICAgIExPQURFRDogJ0xvYWRlZCdcclxufTtcclxuXHJcbmNsYXNzIEltYWdlUmVzb3VyY2Uge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5wcm9ncmVzcyA9IDA7XHJcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBJbWFnZVJlc291cmNlU3RhdHVzLklOSVRJQVRJTkc7XHJcbiAgICAgICAgdGhpcy5vbkxvYWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMub25Qcm9ncmVzcyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vblN0YXR1c0NoYW5nZWQgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBnZXQgSU1BR0VfU1RBVFVTKCkge1xyXG4gICAgICAgIHJldHVybiBJbWFnZVJlc291cmNlU3RhdHVzO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBsb2FkZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhdHVzID09IEltYWdlUmVzb3VyY2VTdGF0dXMuTE9BREVEO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFByb2dyZXNzKHByb2dyZXNzKSB7XHJcbiAgICAgICAgdGhpcy5wcm9ncmVzcyA9IHByb2dyZXNzO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhgSW1hZ2VSZXNvdXJjZS5zZXRQcm9ncmVzczogJHtwcm9ncmVzc31gKTtcclxuXHJcbiAgICAgICAgaWYodGhpcy5vblByb2dyZXNzKSB7XHJcbiAgICAgICAgICAgIHRoaXMub25Qcm9ncmVzcyh0aGlzLnByb2dyZXNzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0U3RhdHVzKHN0YXR1cykge1xyXG4gICAgICAgIHRoaXMuc3RhdHVzID0gc3RhdHVzO1xyXG5cclxuICAgICAgICBpZih0aGlzLm9uU3RhdHVzQ2hhbmdlZCkge1xyXG4gICAgICAgICAgICB0aGlzLm9uU3RhdHVzQ2hhbmdlZCh0aGlzLnN0YXR1cyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzd2l0Y2ggKHRoaXMuc3RhdHVzKSB7XHJcbiAgICAgICAgICAgIGNhc2UgSW1hZ2VSZXNvdXJjZVN0YXR1cy5JTklUSUFUSU5HOlxyXG4gICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGNhc2UgSW1hZ2VSZXNvdXJjZVN0YXR1cy5GQUlMRUQ6XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgY2FzZSBJbWFnZVJlc291cmNlU3RhdHVzLkxPQURJTkc6XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgY2FzZSBJbWFnZVJlc291cmNlU3RhdHVzLkxPQURFRDpcclxuICAgICAgICAgICAgdGhpcy5zZXRQcm9ncmVzcygxKTtcclxuICAgICAgICAgICAgaWYodGhpcy5vbkxvYWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub25Mb2FkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRUcmlnZ2VycygpIHtcclxuICAgICAgICBpZih0aGlzLmltZykge1xyXG4gICAgICAgICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmltZy5vbmxvYWRzdGFydCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXR1cyhJbWFnZVJlc291cmNlU3RhdHVzLkxPQURJTkcpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW1nLm9ucHJvZ3Jlc3MgPSBwcm9ncmVzcyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9ncmVzcyA9IHRoaXMuc2V0UHJvZ3Jlc3MocHJvZ3Jlc3MpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW1nLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXR1cyhJbWFnZVJlc291cmNlU3RhdHVzLkxPQURFRCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmltZy5vbmVycm9yID0gKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0dXMoSW1hZ2VSZXNvdXJjZVN0YXR1cy5GQUlMRUQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0U291cmNlKHNvdXJjZSwgYWxpYXMpIHtcclxuICAgICAgICBpZihzb3VyY2UpIHtcclxuICAgICAgICAgICAgaWYoc291cmNlIGluc3RhbmNlb2YgSW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgIGlmKHNvdXJjZS5zcmMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihhbGlhcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFsaWFzID0gYWxpYXM7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmltYWdlU3JjID0gc291cmNlLnNyYztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmltZyA9IHNvdXJjZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoc291cmNlLmNvbXBsZXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdHVzKEltYWdlUmVzb3VyY2VTdGF0dXMuTE9BREVEKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VHJpZ2dlcnMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdJbWFnZVJlc291cmNlIHJlcXVpcmVzIGEgcHJvcGVyIHNvdXJjZS4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKHR5cGVvZiBzb3VyY2UgPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIGlmKGFsaWFzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGlhcyA9IGFsaWFzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VTcmMgPSBzb3VyY2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmltZyA9IG5ldyBJbWFnZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VHJpZ2dlcnMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmltZy5zcmMgPSBzb3VyY2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb21pc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdJbWFnZVJlc291cmNlIHJlcXVpcmVzIGEgcHJvcGVyIHNvdXJjZS4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIFJlc291cmNlcyB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmltYWdlQ2FjaGUgPSBuZXcgTWFwKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAqIEBtZXRob2QgYWRkSW1hZ2UgLSBBZGQgYW4gaW1hZ2UgcmVzb3VyY2UgYW5kIHN0YXJ0cyBsb2FkaW5nIGl0IGlmIHBvc3NpYmxlLlxyXG4gICAgKiBAcGFyYW0ge09iamVjdHxzdHJpbmd9IGltZ1NvdXJjZSAtIGltYWdlIHNvdXJjZS4gSXQgbWF5IGJlIGFuIGltZyBlbGVtZW50IG9iamVjdCBvciB0aGUgaW1nIHVybCBzdHJpbmcuXHJcbiAgICAqIEBwYXJhbSB7c3RyaW5nfSBbYWxpYXNdIC0gaW1hZ2UgYWxpYXMgdXNlZCB0byByZXRyaWV2ZSByZXNvdXJjZS4gaWYgaW1nU291cmNlIGlzIGEgc3RyaW5nIGFuZCBhbGlhcyBpcyBub3Qgc3BlY2lmaWVkLCB0aGVuIHRoZSBhbGlhcyB3aWxsIGJlIHNldCB0byB0aGUgaW1nU291cmNlLlxyXG4gICAgKiBAcmV0dXJuIHtQcm9taXNzZX0gLSBwcm9taXNlIHRoYXQgZnVsbGZpbGxzIHdoZW4gdGhlIHJlc291cmNlIGhhcyBsb2FkZWQuXHJcbiAgICAqL1xyXG4gICAgYWRkSW1hZ2UoaW1nU291cmNlLCBhbGlhcykge1xyXG4gICAgICAgIGlmKCAodHlwZW9mIGltZ1NvdXJjZSA9PSAnc3RyaW5nJykgJiYgIWFsaWFzICkge1xyXG4gICAgICAgICAgICBhbGlhcyA9IGltZ1NvdXJjZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IG5ld0ltYWdlUmVzb3VyY2UgPSBuZXcgSW1hZ2VSZXNvdXJjZSgpO1xyXG5cclxuICAgICAgICBpZighYWxpYXMpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1Jlc291cmNlcy5hZGRJbWFnZTogYWxpYXMgbm90IHNldCBhbmQgdGh1cyB0aGlzIGltYWdlIHdpbGwgbm90IGJlIGNhY2hlZCEnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuaW1hZ2VDYWNoZS5oYXMoYWxpYXMpKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuYWxlcnQoYFJlc291cmNlcy5hZGRJbWFnZTogaW1hZ2UgYWxpYXMgXCIke2FsaWFzfVwiIGlzIGFscmVhZHkgYmVpbmcgdXNlZCBhbmQgd2lsbCBiZSBvdmVyd3JpdHRlbi5gKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5pbWFnZUNhY2hlLnNldChhbGlhcywgbmV3SW1hZ2VSZXNvdXJjZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbmV3SW1hZ2VSZXNvdXJjZS5zZXRTb3VyY2UoaW1nU291cmNlLCBhbGlhcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAqIEBtZXRob2QgYWRkSW1hZ2VzIC0gU2FtZSBhcyBhZGRJbWFnZSBidXQgZm9yIG11bHRwbGUgaW1hZ2UgcmVzb3VyY2VzLlxyXG4gICAgKiBAcGFyYW0ge0FycmF5fSBzb3VyY2VzIC0gZWFjaCBlbGVtZW50IHNob3VsZCBiZSBhbiBhcnJheSB0aGF0IG1hdGNoZXMgdGhlIGFyZ3VtZW50cyBvZiB0aGUgYWRkSW1hZ2UgbWV0aG9kOiBbaW1nU291cmNlLCBhbGlhc10uXHJcbiAgICAqIEByZXR1cm4ge1Byb21pc3NlfSAtIHByb21pc2UgdGhhdCBmdWxsZmlsbHMgd2hlbiBhbGwgcmVzb3VyY2VzIGhhdmUgbG9hZGVkLlxyXG4gICAgKi9cclxuICAgIGFkZEltYWdlcyhzb3VyY2VzKSB7XHJcbiAgICAgICAgaWYoIShzb3VyY2VzIGluc3RhbmNlb2YgQXJyYXkpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Jlc291cmNlcy5hZGRJbWFnZXM6IGFyZ3VtZW50IGlzIG5vdCBhbiBhcnJheScpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcHJvbWlzZXMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yKGNvbnN0IGVudHJ5IG9mIHNvdXJjZXMpIHtcclxuICAgICAgICAgICAgaWYoZW50cnkgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0aGlzLmFkZEltYWdlLmFwcGx5KHRoaXMsIGVudHJ5KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKHRoaXMuYWRkSW1hZ2UoZW50cnkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRPckFkZEltYWdlKGltZ1NvdXJjZSwgYWxpYXMpIHtcclxuICAgICAgICBpZiggKHR5cGVvZiBpbWdTb3VyY2UgPT0gJ3N0cmluZycpICYmICFhbGlhcyApIHtcclxuICAgICAgICAgICAgYWxpYXMgPSBpbWdTb3VyY2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBuZXdJbWFnZVJlc291cmNlID0gbmV3IEltYWdlUmVzb3VyY2UoKTtcclxuXHJcbiAgICAgICAgaWYoIWFsaWFzKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXNvdXJjZXMuYWRkSW1hZ2U6IGFsaWFzIG5vdCBzZXQgYW5kIHRodXMgdGhpcyBpbWFnZSB3aWxsIG5vdCBiZSBjYWNoZWQhJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuaW1hZ2VDYWNoZS5nZXQoYWxpYXMpO1xyXG5cclxuICAgICAgICAgICAgaWYoY2FjaGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjYWNoZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pbWFnZUNhY2hlLnNldChhbGlhcywgbmV3SW1hZ2VSZXNvdXJjZSk7XHJcblxyXG4gICAgICAgIHJldHVybiBuZXdJbWFnZVJlc291cmNlLnNldFNvdXJjZShpbWdTb3VyY2UsIGFsaWFzKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRPckFkZEltYWdlcyhzb3VyY2VzKSB7XHJcbiAgICAgICAgaWYoIShzb3VyY2VzIGluc3RhbmNlb2YgQXJyYXkpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Jlc291cmNlcy5hZGRJbWFnZXM6IGFyZ3VtZW50IGlzIG5vdCBhbiBhcnJheScpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcHJvbWlzZXMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yKGNvbnN0IGVudHJ5IG9mIHNvdXJjZXMpIHtcclxuICAgICAgICAgICAgaWYoZW50cnkgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0aGlzLmdldE9yQWRkSW1hZ2UuYXBwbHkodGhpcywgZW50cnkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2godGhpcy5nZXRPckFkZEltYWdlKGVudHJ5KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAqIEBtZXRob2QgZ2V0SW1hZ2UgLSByZXR1cm5zIHRoZSBpbWcgZWxlbWVudCBvYmplY3QgcmVzcGVjdGl2ZSB0byB0aGUgZ2l2ZW4gYWxpYXMuXHJcbiAgICAqL1xyXG4gICAgZ2V0SW1hZ2UoYWxpYXMpIHtcclxuICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuaW1hZ2VDYWNoZS5nZXQoYWxpYXMpO1xyXG5cclxuICAgICAgICBpZighY2FjaGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignUmVzb3VyY2VzLmdldEltYWdlOiBjb3VsZCBub3QgZmluZCBhbGlhcyBcIiR7YWxpYXN9XCInKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBjYWNoZTtcclxuICAgIH1cclxufVxyXG4iLCJjbGFzcyBUaWxlIHtcclxuICAgIGNvbnN0cnVjdG9yKHJvdywgY29sdW1uLCBzcHJpdGUpIHtcclxuICAgICAgICBpZihzcHJpdGUgaW5zdGFuY2VvZiBJbWFnZSkge1xyXG4gICAgICAgICAgICB0aGlzLnNwcml0ZSA9IHNwcml0ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZihzcHJpdGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignVGlsZS5jb25zdHJ1Y3Rvcjogc3ByaXRlIGlzIG5vdCBhIEltYWdlIG9iamVjdC4nKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByb3cgPSBOdW1iZXIocm93LnRvRml4ZWQoKSk7XHJcbiAgICAgICAgY29sdW1uID0gTnVtYmVyKGNvbHVtbi50b0ZpeGVkKCkpO1xyXG5cclxuICAgICAgICBpZiggKHR5cGVvZiByb3cgPT0gJ251bWJlcicpICYmICh0eXBlb2YgY29sdW1uID09ICdudW1iZXInKSApIHtcclxuICAgICAgICAgICAgdGhpcy5yb3cgPSByb3c7XHJcbiAgICAgICAgICAgIHRoaXMuY29sdW1uID0gY29sdW1uO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignVGlsZS5jb25zdHJ1Y3Rvcjogcm93IGFuZCBjb2x1bW4gbXVzdCBiZSBudW1iZXJzLicpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuaGlnaGxpZ2h0ZWQgPSBmYWxzZTtcclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgVGVycmFpbiB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnRpbGVTaXplWCA9IDY0O1xyXG4gICAgICAgIHRoaXMudGlsZVNpemVZID0gNjQ7XHJcblxyXG4gICAgICAgIHRoaXMudGlsZU1hcCA9IG5ldyBNYXAoKTtcclxuICAgICAgICB0aGlzLnRpbGVIaWdobGlnaHRNYXAgPSBuZXcgTWFwKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHRpbGVzKCkge1xyXG4gICAgICAgIHJldHVybiBbLi4udGhpcy50aWxlTWFwLnZhbHVlcygpXTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgdGlsZVNpemUoKSB7XHJcbiAgICAgICAgcmV0dXJuIFt0aGlzLnRpbGVTaXplWCwgdGhpcy50aWxlU2l6ZVldO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCB0aWxlU2l6ZSh0aWxlU2l6ZSkge1xyXG4gICAgICAgIGlmKCAodGlsZVNpemUgaW5zdGFuY2VvZiBBcnJheSkgJiYgKHRpbGVTaXplLmxlbmd0aCA9PSAyKSAmJiAodHlwZW9mIHRpbGVTaXplWzBdID09ICdudW1iZXInKSAmJiAodHlwZW9mIHRpbGVTaXplWzFdID09ICdudW1iZXInKSApIHtcclxuICAgICAgICAgICAgdGhpcy50aWxlU2l6ZVggPSB0aWxlU2l6ZVswXTtcclxuICAgICAgICAgICAgdGhpcy50aWxlU2l6ZVkgPSB0aWxlU2l6ZVsxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3NldCBUZXJyYWluLnRpbGVTaXplOiB0aWxlU2l6ZSBpcyBub3QgYW4gYXJyYXkgb2Ygc2l6ZSAyIHRoYXQgY29udGFpbnMgbnVtYmVycy4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHNldFRpbGUodGlsZSkge1xyXG4gICAgICAgIGlmKCEodGlsZSBpbnN0YW5jZW9mIFRpbGUpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RlcnJhaW4uc2V0VGlsZTogdGlsZSBpcyBub3QgYSBUaWxlIG9iamVjdC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudGlsZU1hcC5zZXQoYCR7dGlsZS5yb3d9eCR7dGlsZS5jb2x1bW59YCwgdGlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldFRpbGVzKHRpbGVzKSB7XHJcbiAgICAgICAgaWYoISh0aWxlcyBpbnN0YW5jZW9mIEFycmF5KSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdUZXJyYWluLnNldFRpbGVzOiB0aWxlcyBpcyBub3QgYW4gQXJyYXkuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmb3IoY29uc3QgdGlsZSBvZiB0aWxlcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUaWxlKHRpbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldFRpbGVIaWdobGlnaHQocm93LCBjb2x1bW4sIGhpZ2hsaWdodGVkID0gdHJ1ZSkge1xyXG4gICAgICAgIGlmKCAodHlwZW9mIHJvdyA9PSAnbnVtYmVyJykgJiYgKHR5cGVvZiBjb2x1bW4gPT0gJ251bWJlcicpICYmICh0eXBlb2YgaGlnaGxpZ2h0ZWQgPT0gJ2Jvb2xlYW4nKSApIHtcclxuICAgICAgICAgICAgbGV0IHRpbGUgPSB0aGlzLnRpbGVNYXAuZ2V0KGAke3Jvd314JHtjb2x1bW59YCk7XHJcbiAgICAgICAgICAgIGlmKCF0aWxlKSB7XHJcbiAgICAgICAgICAgICAgICB0aWxlID0gbmV3IFRpbGUocm93LCBjb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUaWxlKHRpbGUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aWxlLmhpZ2hsaWdodGVkID0gaGlnaGxpZ2h0ZWQ7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGlsZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RlcnJhaW4uc2V0VGlsZUhpZ2hsaWdodDogcm93IGFuZCBjb2x1bW4gbXVzdCBiZSBudW1iZXJzIGFuZCBoaWdobGlnaHRlZCBtdXN0IGJlIGEgYm9vbGVhbi4nKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyKCkge1xyXG4gICAgICAgIHRoaXMudGlsZU1hcC5jbGVhcigpO1xyXG4gICAgICAgIHRoaXMudGlsZUhpZ2hsaWdodE1hcCA9IG5ldyBNYXAoKTtcclxuICAgIH1cclxufVxyXG4iXX0=
